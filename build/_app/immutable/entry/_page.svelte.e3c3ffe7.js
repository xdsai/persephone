import{S as ht,i as mt,s as pt,k as b,a as G,q as H,l as g,m as y,h as p,c as M,r as W,n as d,b as pe,G as i,J as tt,K as $,u as He,g as We,v as Pt,d as Fe,f as Tt,L as bt,M as Ye,o as jt,N as Vt,y as gt,z as vt,A as yt,O as Se,H as Ge,B as _t,t as nt,P as De,w as Me,e as rt}from"../chunks/index.0cd60f9d.js";import{P as Ot,S as Le}from"../chunks/PersephoneRun.03549fd7.js";const Qe="persephone.fs.v1";function Rt(){try{localStorage.removeItem(Qe)}catch{}}function Je(){return Date.now()}function X(r,e=[]){const t=Je();return{name:r,type:"dir",children:e,createdAt:t,updatedAt:t}}function S(r,e=""){const t=Je();return{name:r,type:"file",content:e,createdAt:t,updatedAt:t}}function Lt(r){return JSON.stringify(r)}function Ht(r){try{return JSON.parse(r)}catch{return null}}function Ce(r){try{localStorage.setItem(Qe,Lt(r))}catch{}}function Wt(){try{const r=localStorage.getItem(Qe);return r?Ht(r):null}catch{return null}}function st(){return{root:X("/",[X("bin",[S("ls",""),S("cat",""),S("echo",""),S("pwd",""),S("cd",""),S("ip","")]),X("usr",[X("bin",[S("node",""),S("bash","")]),X("share",[S("dict.txt","why are you looking here >:(")])]),X("var",[X("log",[S("auth.log","accepted connection"),S("kern.log","boot ok")]),X("tmp")]),X("proc",[S("cpuinfo","cpu: webasm"),S("meminfo","mem: virtual")]),X("etc",[S("hostname",`jndl
`),S("hosts",`127.0.0.1 localhost
::1 localhost
`),S("os-release",`NAME=Web
ID=web`)]),X("home",[X("alex",[S("README.md",`# Alexander Jandl

Welcome to my terminal. Try \`help\` to see commands.

Useful places:
- ~/about.txt
- ~/skills.md
- ~/projects
`),S("about.txt","Infrastructure & security focused engineer based in Bratislava. I like reliable automation, scalable systems, and cats."),S("skills.md",`- Linux, networking, network security
- AWS & Azure platform security
- Scripting: Bash, Python, Powershell, C
- Zero-trust, identity, and least privilege`),{...S("blog","Open the personal blog"),link:"/blog"},X("projects",[{...S("persephone",`personal webpage, vibecoded from scratch.
i don't know any frontend :D`),link:"https://github.com/xdsai/persephone"}]),X("socials",[{...S("github","my github profile"),link:"https://github.com/xdsai"},{...S("linkedin","my linkedin profile"),link:"https://www.linkedin.com/in/jndl/"},{...S("email","email me something nice! no nigerian princes please"),link:"mailto:alex@jndl.dev"}])])]),X("tmp")]),cwd:"/home/alex"}}function xe(r){if(!r)return"/";let e=r.replace(/\\/g,"/");e.startsWith("/")||(e="/"+e);const t=[];for(const n of e.split("/"))!n||n==="."||(n===".."?t.pop():t.push(n));return"/"+t.join("/")}function me(r,e){return!e||e==="."?xe(r):e.startsWith("/")?xe(e):xe(r+"/"+e)}function Ae(r,e){const t=xe(e).split("/").filter(Boolean);if(t.length===0)return{node:r,parent:null};let n=r,s=null,o=r;for(const a of t){if(!n)return{node:null,parent:null};const h=n.children.find(v=>v.name===a)||null;if(s=n,o=h,!h)return{node:null,parent:s};n=h.type==="dir"?h:null}return{node:o,parent:s}}function Ue(r,e,t=!1){const n=xe(e);if(n==="/")return{node:r,created:!1};const s=n.split("/").filter(Boolean);let o=r,a=!1;for(const h of s){let v=o.children.find(w=>w.name===h);if(!v){if(!t)return{node:null,created:a};v=X(h),o.children.push(v),a=!0}if(v.type!=="dir")return{node:null,created:a};o=v}return{node:o,created:a}}function xt(r,e,t=!1){const{node:n,parent:s}=Ae(r,e);if(!n||!s||n.type==="dir"&&n.children.length&&!t)return!1;const o=s.children.findIndex(a=>a.name===n.name);return o>=0&&s.children.splice(o,1),!0}function lt(r,e,t){const n=r.slice();return n[59]=e[t],n}function ot(r,e,t){const n=r.slice();return n[62]=e[t],n}function at(r){let e,t=r[62].html+"";return{c(){e=b("div"),this.h()},l(n){e=g(n,"DIV",{class:!0});var s=y(e);s.forEach(p),this.h()},h(){d(e,"class","row svelte-1mt2qmb")},m(n,s){pe(n,e,s),e.innerHTML=t},p(n,s){s[0]&32&&t!==(t=n[62].html+"")&&(e.innerHTML=t)},d(n){n&&p(e)}}}function it(r){let e,t,n,s,o,a,h,v,w,C,ee,te,F;return C=new Ot({props:{src:"/story.json"}}),{c(){e=b("div"),t=b("div"),n=b("div"),s=H("NEON THIRTEEN — PERSEPHONE RUN"),o=G(),a=b("button"),h=H("×"),v=G(),w=b("div"),gt(C.$$.fragment),this.h()},l(q){e=g(q,"DIV",{class:!0,role:!0,"aria-label":!0});var ne=y(e);t=g(ne,"DIV",{class:!0});var V=y(t);n=g(V,"DIV",{class:!0});var B=y(n);s=W(B,"NEON THIRTEEN — PERSEPHONE RUN"),B.forEach(p),o=M(V),a=g(V,"BUTTON",{class:!0,"aria-label":!0});var I=y(a);h=W(I,"×"),I.forEach(p),v=M(V),w=g(V,"DIV",{class:!0});var K=y(w);vt(C.$$.fragment,K),K.forEach(p),V.forEach(p),ne.forEach(p),this.h()},h(){d(n,"class","obartitle svelte-1mt2qmb"),d(a,"class","close svelte-1mt2qmb"),d(a,"aria-label","close"),d(w,"class","content svelte-1mt2qmb"),d(t,"class","box svelte-1mt2qmb"),d(e,"class","overlay svelte-1mt2qmb"),d(e,"role","dialog"),d(e,"aria-label","persephone game")},m(q,ne){pe(q,e,ne),i(e,t),i(t,n),i(n,s),i(t,o),i(t,a),i(a,h),i(t,v),i(t,w),yt(C,w,null),ee=!0,te||(F=[$(a,"click",r[32]),$(t,"click",Se(r[26])),$(t,"keydown",Se(r[27])),$(e,"click",Se(r[24])),$(e,"keydown",Se(r[25]))],te=!0)},p:Ge,i(q){ee||(We(C.$$.fragment,q),ee=!0)},o(q){Fe(C.$$.fragment,q),ee=!1},d(q){q&&p(e),_t(C),te=!1,Ye(F)}}}function ct(r){let e,t,n,s,o,a,h,v,w,C,ee,te,F,q=JSON.stringify(r[14],null,2)+"",ne,V,B,I,K,ce,Y,N,z,U,le,se,be,P,fe;function oe(J,Q){return J[9]?Ct:Bt}let ue=oe(r),D=ue(r);return{c(){e=b("div"),t=b("div"),n=b("div"),s=H("Signal Bloom — ARG Panel"),o=G(),a=b("button"),h=H("×"),v=G(),w=b("div"),C=b("div"),ee=H("Steganographic shards"),te=G(),F=b("pre"),ne=H(q),V=G(),B=b("div"),I=b("div"),K=H("Discovered lore"),ce=G(),D.c(),Y=G(),N=b("div"),z=b("a"),U=H("Resume Story"),le=G(),se=b("a"),be=H("Open blog entry"),this.h()},l(J){e=g(J,"DIV",{class:!0,role:!0,"aria-label":!0});var Q=y(e);t=g(Q,"DIV",{class:!0});var Z=y(t);n=g(Z,"DIV",{class:!0});var ge=y(n);s=W(ge,"Signal Bloom — ARG Panel"),ge.forEach(p),o=M(Z),a=g(Z,"BUTTON",{class:!0,"aria-label":!0});var ie=y(a);h=W(ie,"×"),ie.forEach(p),v=M(Z),w=g(Z,"DIV",{class:!0});var he=y(w);C=g(he,"DIV",{class:!0});var qe=y(C);ee=W(qe,"Steganographic shards"),qe.forEach(p),te=M(he),F=g(he,"PRE",{class:!0});var de=y(F);ne=W(de,q),de.forEach(p),he.forEach(p),V=M(Z),B=g(Z,"DIV",{class:!0});var O=y(B);I=g(O,"DIV",{class:!0});var T=y(I);K=W(T,"Discovered lore"),T.forEach(p),ce=M(O),D.l(O),O.forEach(p),Y=M(Z),N=g(Z,"DIV",{class:!0});var L=y(N);z=g(L,"A",{class:!0,href:!0});var _=y(z);U=W(_,"Resume Story"),_.forEach(p),le=M(L),se=g(L,"A",{class:!0,href:!0});var j=y(se);be=W(j,"Open blog entry"),j.forEach(p),L.forEach(p),Z.forEach(p),Q.forEach(p),this.h()},h(){d(n,"class","obartitle svelte-1mt2qmb"),d(a,"class","close svelte-1mt2qmb"),d(a,"aria-label","close"),d(C,"class","arghead svelte-1mt2qmb"),d(F,"class","payload svelte-1mt2qmb"),d(w,"class","argsec svelte-1mt2qmb"),d(I,"class","arghead svelte-1mt2qmb"),d(B,"class","argsec svelte-1mt2qmb"),d(z,"class","nav svelte-1mt2qmb"),d(z,"href","/blog/neon-thirteen-persephone-run#persephone"),d(se,"class","nav svelte-1mt2qmb"),d(se,"href","/blog/neon-thirteen-persephone-run"),d(N,"class","argsec links svelte-1mt2qmb"),d(t,"class","box arg svelte-1mt2qmb"),d(e,"class","overlay svelte-1mt2qmb"),d(e,"role","dialog"),d(e,"aria-label","ARG panel")},m(J,Q){pe(J,e,Q),i(e,t),i(t,n),i(n,s),i(t,o),i(t,a),i(a,h),i(t,v),i(t,w),i(w,C),i(C,ee),i(w,te),i(w,F),i(F,ne),i(t,V),i(t,B),i(B,I),i(I,K),i(B,ce),D.m(B,null),i(t,Y),i(t,N),i(N,z),i(z,U),i(N,le),i(N,se),i(se,be),P||(fe=[$(a,"click",r[33]),$(t,"click",Se(r[22])),$(t,"keydown",Se(r[23])),$(e,"click",Se(r[20])),$(e,"keydown",Se(r[21]))],P=!0)},p(J,Q){ue===(ue=oe(J))&&D?D.p(J,Q):(D.d(1),D=ue(J),D&&(D.c(),D.m(B,null)))},d(J){J&&p(e),D.d(),P=!1,Ye(fe)}}}function Bt(r){let e,t;return{c(){e=b("div"),t=H("no registry"),this.h()},l(n){e=g(n,"DIV",{class:!0});var s=y(e);t=W(s,"no registry"),s.forEach(p),this.h()},h(){d(e,"class","dim")},m(n,s){pe(n,e,s),i(e,t)},p:Ge,d(n){n&&p(e)}}}function Ct(r){let e;function t(o,a){var h,v,w;return(w=(v=(h=o[10])==null?void 0:h.state)==null?void 0:v.loreDiscoveries)!=null&&w.length?Jt:Ft}let n=t(r),s=n(r);return{c(){s.c(),e=rt()},l(o){s.l(o),e=rt()},m(o,a){s.m(o,a),pe(o,e,a)},p(o,a){n===(n=t(o))&&s?s.p(o,a):(s.d(1),s=n(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&p(e)}}}function Ft(r){let e,t;return{c(){e=b("div"),t=H("no lore discovered"),this.h()},l(n){e=g(n,"DIV",{class:!0});var s=y(e);t=W(s,"no lore discovered"),s.forEach(p),this.h()},h(){d(e,"class","dim")},m(n,s){pe(n,e,s),i(e,t)},p:Ge,d(n){n&&p(e)}}}function Jt(r){let e,t=r[15](r[10]),n=[];for(let s=0;s<t.length;s+=1)n[s]=dt(lt(r,t,s));return{c(){e=b("ul");for(let s=0;s<n.length;s+=1)n[s].c()},l(s){e=g(s,"UL",{});var o=y(e);for(let a=0;a<n.length;a+=1)n[a].l(o);o.forEach(p)},m(s,o){pe(s,e,o);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(s,o){if(o[0]&33792){t=s[15](s[10]);let a;for(a=0;a<t.length;a+=1){const h=lt(s,t,a);n[a]?n[a].p(h,o):(n[a]=dt(h),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(s){s&&p(e),bt(n,s)}}}function ut(r){let e,t,n=r[59].summary+"",s;return{c(){e=b("span"),t=H("— "),s=H(n),this.h()},l(o){e=g(o,"SPAN",{class:!0});var a=y(e);t=W(a,"— "),s=W(a,n),a.forEach(p),this.h()},h(){d(e,"class","lsum svelte-1mt2qmb")},m(o,a){pe(o,e,a),i(e,t),i(e,s)},p(o,a){a[0]&1024&&n!==(n=o[59].summary+"")&&He(s,n)},d(o){o&&p(e)}}}function dt(r){let e,t,n=r[59].title+"",s,o=r[59].summary&&ut(r);return{c(){e=b("li"),t=b("span"),s=H(n),o&&o.c(),this.h()},l(a){e=g(a,"LI",{});var h=y(e);t=g(h,"SPAN",{class:!0});var v=y(t);s=W(v,n),v.forEach(p),o&&o.l(h),h.forEach(p),this.h()},h(){d(t,"class","ltitle svelte-1mt2qmb")},m(a,h){pe(a,e,h),i(e,t),i(t,s),o&&o.m(e,null)},p(a,h){h[0]&1024&&n!==(n=a[59].title+"")&&He(s,n),a[59].summary?o?o.p(a,h):(o=ut(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(a){a&&p(e),o&&o.d()}}}function Gt(r){let e,t,n,s,o,a,h,v,w,C,ee,te,F=Ke(r[0].cwd)+"",q,ne,V,B,I,K,ce,Y,N,z,U,le,se,be,P,fe,oe,ue,D,J,Q,Z,ge,ie,he,qe,de=r[5],O=[];for(let _=0;_<de.length;_+=1)O[_]=at(ot(r,de,_));let T=r[7]&&it(r),L=r[8]&&ct(r);return{c(){e=b("div"),t=b("div"),n=b("div"),s=b("span"),o=b("span"),a=b("span"),h=G(),v=b("span"),w=H(Ve),C=H("@"),ee=H(ze),te=H(" — "),q=H(F),ne=G(),V=b("span"),B=H("up "),I=H(r[4]),K=H(" min"),ce=G(),Y=b("div"),N=b("div");for(let _=0;_<O.length;_+=1)O[_].c();z=G(),U=b("div"),le=b("span"),se=H(r[11]),be=G(),P=b("input"),fe=G(),oe=b("div"),ue=G(),D=b("div"),J=G(),Q=b("div"),Z=G(),T&&T.c(),ge=G(),L&&L.c(),this.h()},l(_){e=g(_,"DIV",{class:!0,tabindex:!0,role:!0,"aria-label":!0});var j=y(e);t=g(j,"DIV",{class:!0});var A=y(t);n=g(A,"DIV",{class:!0});var ve=y(n);s=g(ve,"SPAN",{class:!0}),y(s).forEach(p),o=g(ve,"SPAN",{class:!0}),y(o).forEach(p),a=g(ve,"SPAN",{class:!0}),y(a).forEach(p),ve.forEach(p),h=M(A),v=g(A,"SPAN",{class:!0,style:!0});var _e=y(v);w=W(_e,Ve),C=W(_e,"@"),ee=W(_e,ze),te=W(_e," — "),q=W(_e,F),_e.forEach(p),ne=M(A),V=g(A,"SPAN",{class:!0});var Te=y(V);B=W(Te,"up "),I=W(Te,r[4]),K=W(Te," min"),Te.forEach(p),A.forEach(p),ce=M(j),Y=g(j,"DIV",{class:!0});var ke=y(Y);N=g(ke,"DIV",{class:!0});var we=y(N);for(let Oe=0;Oe<O.length;Oe+=1)O[Oe].l(we);z=M(we),U=g(we,"DIV",{class:!0});var je=y(U);le=g(je,"SPAN",{class:!0,"aria-hidden":!0});var Be=y(le);se=W(Be,r[11]),Be.forEach(p),be=M(je),P=g(je,"INPUT",{class:!0,type:!0,spellcheck:!0,autocapitalize:!0,autocomplete:!0,autocorrect:!0}),je.forEach(p),fe=M(we),oe=g(we,"DIV",{class:!0,"aria-hidden":!0}),y(oe).forEach(p),we.forEach(p),ue=M(ke),D=g(ke,"DIV",{class:!0,"aria-hidden":!0}),y(D).forEach(p),J=M(ke),Q=g(ke,"DIV",{class:!0,"aria-hidden":!0}),y(Q).forEach(p),ke.forEach(p),Z=M(j),T&&T.l(j),ge=M(j),L&&L.l(j),j.forEach(p),this.h()},h(){d(s,"class","dot r svelte-1mt2qmb"),d(o,"class","dot y svelte-1mt2qmb"),d(a,"class","dot g svelte-1mt2qmb"),d(n,"class","controls svelte-1mt2qmb"),d(v,"class","title svelte-1mt2qmb"),d(v,"style",`animation: glitch ${r[12].toFixed(2)}s infinite steps(2); animation-delay:${r[13].toFixed(2)}s`),d(V,"class","uptime svelte-1mt2qmb"),d(t,"class","titlebar svelte-1mt2qmb"),d(le,"class","prompt svelte-1mt2qmb"),d(le,"aria-hidden","true"),d(P,"class","readline svelte-1mt2qmb"),d(P,"type","text"),d(P,"spellcheck","false"),d(P,"autocapitalize","off"),d(P,"autocomplete","off"),d(P,"autocorrect","off"),d(U,"class","row input svelte-1mt2qmb"),d(oe,"class","end svelte-1mt2qmb"),d(oe,"aria-hidden","true"),d(N,"class","terminal svelte-1mt2qmb"),d(D,"class","fx fx-scan svelte-1mt2qmb"),d(D,"aria-hidden","true"),d(Q,"class","fx fx-noise svelte-1mt2qmb"),d(Q,"aria-hidden","true"),d(Y,"class","term-pane svelte-1mt2qmb"),d(e,"class","terminal-wrap svelte-1mt2qmb"),d(e,"tabindex","0"),d(e,"role","group"),d(e,"aria-label","web terminal")},m(_,j){pe(_,e,j),i(e,t),i(t,n),i(n,s),i(n,o),i(n,a),i(t,h),i(t,v),i(v,w),i(v,C),i(v,ee),i(v,te),i(v,q),i(t,ne),i(t,V),i(V,B),i(V,I),i(V,K),i(e,ce),i(e,Y),i(Y,N);for(let A=0;A<O.length;A+=1)O[A]&&O[A].m(N,null);i(N,z),i(N,U),i(U,le),i(le,se),i(U,be),i(U,P),r[28](P),tt(P,r[3]),i(N,fe),i(N,oe),r[30](oe),r[31](N),i(Y,ue),i(Y,D),i(Y,J),i(Y,Q),i(e,Z),T&&T.m(e,null),i(e,ge),L&&L.m(e,null),ie=!0,he||(qe=[$(P,"input",r[29]),$(P,"keydown",r[17]),$(N,"click",r[18]),$(N,"keydown",r[19]),$(e,"click",r[16]),$(e,"keydown",r[34])],he=!0)},p(_,j){if((!ie||j[0]&1)&&F!==(F=Ke(_[0].cwd)+"")&&He(q,F),(!ie||j[0]&16)&&He(I,_[4]),j[0]&32){de=_[5];let A;for(A=0;A<de.length;A+=1){const ve=ot(_,de,A);O[A]?O[A].p(ve,j):(O[A]=at(ve),O[A].c(),O[A].m(N,z))}for(;A<O.length;A+=1)O[A].d(1);O.length=de.length}(!ie||j[0]&2048)&&He(se,_[11]),j[0]&8&&P.value!==_[3]&&tt(P,_[3]),_[7]?T?(T.p(_,j),j[0]&128&&We(T,1)):(T=it(_),T.c(),We(T,1),T.m(e,ge)):T&&(Pt(),Fe(T,1,1,()=>{T=null}),Tt()),_[8]?L?L.p(_,j):(L=ct(_),L.c(),L.m(e,null)):L&&(L.d(1),L=null)},i(_){ie||(We(T),ie=!0)},o(_){Fe(T),ie=!1},d(_){_&&p(e),bt(O,_),r[28](null),r[30](null),r[31](null),T&&T.d(),L&&L.d(),he=!1,Ye(qe)}}}let ze="jndl",Ve="alex";async function ft(r){var s;if(typeof((s=crypto==null?void 0:crypto.subtle)==null?void 0:s.digest)!="function")return"sha256:unavailable";const e=new TextEncoder().encode(r),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(o=>o.toString(16).padStart(2,"0")).join("")}function Ke(r){const e="/home/"+Ve;return r===e?"~":r.startsWith(e+"/")?"~"+r.slice(e.length):r}function Mt(r){const e=[];let t="",n=!1;for(let s=0;s<r.length;s++){const o=r[s];if(o==='"'){n=!n;continue}if(!n&&/\s/.test(o)){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(t),e}function Pe(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ut(r){return r==="~"||r.startsWith("~/")?"/home/"+Ve+(r.length>1?r.slice(1):""):r}function zt(r){if(!r.length)return"";let e=r[0];for(const t of r.slice(1)){let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;if(e=e.slice(0,n),!e)break}return e}function*kt(r,e){for(const t of r.children){const n=t.type==="dir";yield`${e}${t.name}${n?"/":""}`,n&&(yield*kt(t,e+"  "))}}function Kt(r,e,t){let n,s=st(),o,a,h="",v=[],w=-1;const C=new Date;let ee=0,te=null,F=[],q;const ne={help:"help — list available commands",ls:"ls [path] — list directory contents (click names to open)",tree:"tree [path] — show directory tree",pwd:"pwd — print working directory",cd:"cd <path> — change directory",cat:"cat <file> — print file to terminal",echo:'echo "text" > file — write or append with >>',touch:"touch <file> — create an empty file",mkdir:"mkdir [-p] <dir> — create directory",rm:"rm [-r] <path> — remove file or directory",clear:"clear — clear the screen",whoami:"whoami — print current user",date:"date — print current date/time",uname:"uname — print kernel info",ip:"ip — print public IP address",man:"man <cmd> — show a short description",resetfs:"resetfs — reset filesystem to defaults (clears local storage)",play:"play — open the Persephone story",save:"save — save current Persephone run",load:"load — load saved Persephone run",reset:"reset — reset Persephone run","persephone --bloom":"persephone --bloom — attempt to bloom the signal","whois alex":"whois alex — post metadata + checksum hint"};let V=!1,B=!1,I=null,K=null,ce=null;const Y=4+Math.random()*4,N=Math.random()*3;function z(){try{const l=localStorage.getItem(Le);t(10,ce=l?JSON.parse(l):null)}catch{t(10,ce=null)}}async function U(){var l,f;if(!I){try{const m=await fetch("/story.json");if(m.ok){const u=await m.json();I=u.meta||null,t(9,K=((l=u.meta)==null?void 0:l.loreRegistry)||null);return}}catch{}try{const u=await(await fetch("/assets/persephone-run.json")).json();I=u.meta||null,t(9,K=((f=u.meta)==null?void 0:f.loreRegistry)||null)}catch{}}}const le={status:"decrypted",shards:6,hint:"six seeds bloom a signal",routes:["/blog/welcome","/"]};function se(l){var f;try{const m=((f=l==null?void 0:l.state)==null?void 0:f.loreDiscoveries)||[];return!Array.isArray(m)||!K?[]:m.map(u=>K.find(k=>k.slug===u)).filter(Boolean)}catch{return[]}}function be(){const l=Wt();l?t(0,s=l):Ce(s),D('<span class="g">Welcome</span> — type <span class="y">help</span> to get started.'),D(`<div class="onboard">Quick start:
      <a href="#" class="cmd" data-cmd="ls">list files</a>
      · <a href="/blog" class="nav">blog</a>
      <div class="hint">Tip: use <b>ls</b> to list, <b>cat &lt;file&gt;</b> to read, <b>cd &lt;dir&gt;</b> to open</div>
    </div>`),D('<div class="onboard"><span class="y">hints</span>: names resolve to records · six seeds bloom a signal</div>')}function P(){a==null||a.focus()}let fe=null;function oe(l=3){!o||o.scrollHeight-o.scrollTop-o.clientHeight<2||(t(1,o.scrollTop=o.scrollHeight,o),l>0&&requestAnimationFrame(()=>oe(l-1)))}function ue(){q!=null&&q.scrollIntoView&&q.scrollIntoView({block:"end"}),fe&&cancelAnimationFrame(fe),fe=requestAnimationFrame(()=>oe(2))}function D(l){t(5,F=[...F,{html:l}]),nt().then(()=>{ue()})}async function J(l){var x,re,ae,Re,Ee,Ze,Xe,$e,et;const f=l.trim();if(D(`<span class="cmdline"><span class="prompt">${Pe(n)}</span> <span class="cmdtext">${Pe(l)}</span></span>`),!f)return;v.push(l),w=v.length;const[m,...u]=Mt(f),k=[],c=(Ie,ye=!1)=>k.push({text:Ie,raw:ye});try{const Ie=(m||"").toLowerCase(),ye=u.map(R=>(R||"").toLowerCase());switch(Ie){case"help":c(Object.keys(ne).join(", "));break;case"pwd":c(s.cwd);break;case"whoami":c(Ve);break;case"date":c(new Date().toString());break;case"uname":c("Linux persephone 6.1.0 x86_64 (web)");break;case"ip":{try{const E=await(await fetch("https://api.ipify.org?format=json",{cache:"no-store"})).json();c(`public: ${E.ip}`)}catch{c("ip: unable to fetch external IP")}break}case"clear":t(5,F=[]),await nt(),ue(),P();break;case"cd":ge(u,c);break;case"ls":ie(u,c);break;case"tree":he(u,c);break;case"cat":qe(u,c);break;case"echo":de(u,c);break;case"touch":O(u,c);break;case"mkdir":T(u,c);break;case"rm":L(u,c);break;case"resetfs":{Rt(),t(0,s=st()),Ce(s),c("filesystem reset to defaults");break}case"man":{const R=u[0];if(!R){c("man: missing command");break}const E=ne[R];c(E||`No manual entry for ${R}`);break}case"play":{await U(),t(7,V=!0),c("opening game…");break}case"save":{c("persephone: auto-saved (if a run is in progress).");break}case"load":{if(!!!localStorage.getItem(Le)){c("persephone: no save found");break}t(7,V=!0),c("persephone: loaded (open window).");break}case"reset":{localStorage.removeItem(Le),c("persephone: save cleared");break}case"whois":{await U();const R=(ye[0]||"").toLowerCase();if(R==="alex"){if(!(I!=null&&I.webTieIn)){c("whois: info unavailable");break}const E=I.webTieIn,Ne=await ft(`${E.blogTitle}|${E.blogDate}`);c(`title: ${E.blogTitle}
date: ${E.blogDate}
author: ${E.blogAuthor}
summary: ${E.summary||""}
checksum: ${Ne.slice(0,16)}…`)}else if(R==="johnny")try{const E=localStorage.getItem("persephone-run-v1:save"),Ne=E?JSON.parse(E):null,Nt=!!(((x=Ne==null?void 0:Ne.state)==null?void 0:x.loreDiscoveries)||[]).includes("johnny-silverhand");c(Nt?"record shows JOHNNY S— (silver tape wrapped on right hand).":"record incomplete.")}catch{c("record incomplete.")}else c("whois: try `whois alex`");break}case"persephone":{if(ye[0]==="--bloom"){await U();try{const R=localStorage.getItem(Le);if(!R){c("no bloom: signal dormant");break}const E=JSON.parse(R);!!((ae=(re=E==null?void 0:E.state)==null?void 0:re.flags)!=null&&ae.blogPosted)&&((Ee=(Re=E==null?void 0:E.state)==null?void 0:Re.flags)==null?void 0:Ee.blogClean)===!1?(t(8,B=!0),c("bloom: signal decrypted (open panel)"),z()):c("no bloom: signal dormant")}catch{c("no bloom: signal dormant")}}else c("persephone: unknown flag");break}case"pomegranate":case"kore13":{await U();try{const R=localStorage.getItem(Le);if(!R){c("no bloom: signal dormant");break}const E=JSON.parse(R);!!((Xe=(Ze=E==null?void 0:E.state)==null?void 0:Ze.flags)!=null&&Xe.blogPosted)&&((et=($e=E==null?void 0:E.state)==null?void 0:$e.flags)==null?void 0:et.blogClean)===!1?(t(8,B=!0),c("bloom: signal decrypted (open panel)"),z()):c("no bloom: signal dormant")}catch{c("no bloom: signal dormant")}break}default:if(Ie+" "+(ye[0]||"")=="whois alex"){if(await U(),!(I!=null&&I.webTieIn)){c("whois: info unavailable");break}const R=I.webTieIn,E=await ft(`${R.blogTitle}|${R.blogDate}`);c(`title: ${R.blogTitle}
date: ${R.blogDate}
author: ${R.blogAuthor}
summary: ${R.summary||""}
checksum: ${E.slice(0,16)}…`)}else c(`${m}: command not found`)}}catch(Ie){c(String(Ie))}if(k.length){const Ie=k.map(ye=>ye.raw?ye.text:Pe(ye.text)).join(`
`);D(Ie)}Ce(s)}function Q(l){const f=Ut(l),m=f.startsWith("/")?f:me(s.cwd,f),u=m.endsWith("/"),k=u?m:m.substring(0,m.lastIndexOf("/")>=0?m.lastIndexOf("/"):0),c=u?"":m.split("/").pop()||"",x=Ae(s.root,k||"/").node;if(!x||x.type!=="dir")return{next:null,suggestions:[]};const ae=x.children.map(Ee=>Ee.type==="dir"?Ee.name+"/":Ee.name).filter(Ee=>Ee.startsWith(c));if(ae.length===0)return{next:null,suggestions:[]};if(ae.length===1)return{next:u?m:k+"/"+ae[0],suggestions:ae};const Re=zt(ae);return Re.length>c.length?{next:k+"/"+Re,suggestions:ae}:{next:null,suggestions:ae}}function Z(){let l=!1,f=-1;for(let x=0;x<h.length;x++){const re=h[x];re==='"'&&(l=!l),!l&&/\s/.test(re)&&(f=x)}const m=h.slice(0,f+1),u=h.slice(f+1);if(!u)return;const{next:k,suggestions:c}=Q(u);if(k){const x=k.startsWith(s.cwd)?k.replace(s.cwd,"").replace(/^\//,""):k;t(3,h=m+x);return}c.length&&D(c.join("  "))}function ge(l,f){const m=me(s.cwd,l[0]??"/"),u=Ae(s.root,m);if(!u.node)return f(`cd: no such file or directory: ${l[0]??"/"}`);if(u.node.type!=="dir")return f(`cd: not a directory: ${l[0]}`);t(0,s.cwd=m,s)}function ie(l,f){const m=me(s.cwd,l[0]??"."),{node:u}=Ae(s.root,m);if(!u)return f(`ls: cannot access '${l[0]??"."}': No such file or directory`);if(u.type==="file")return f(u.name);me("/",m);const k=u.children.map(c=>{const x=c.type==="dir"?c.name+"/":c.name;if(c.type==="dir")return Pe(x);const re=c;return re.link?`<a href="${re.link}" class="nav">${Pe(x)}</a>`:Pe(x)}).join("  ");f(k,!0)}function he(l,f){const m=me(s.cwd,l[0]??"."),{node:u}=Ae(s.root,m);if(!u)return f(`tree: ${l[0]??"."}: No such file or directory`);if(u.type==="file")return f(u.name);f(u.name||"/"),f([...kt(u,"  ")].join(`
`))}function qe(l,f){if(!l[0])return f("cat: missing file operand");const m=me(s.cwd,l[0]),{node:u}=Ae(s.root,m);if(!u)return f(`cat: ${l[0]}: No such file or directory`);if(u.type!=="file")return f(`cat: ${l[0]}: Is a directory`);f(u.content)}function de(l,f){const m=l.findIndex(u=>u===">"||u===">>");if(m>=0){const u=l.slice(0,m).join(" "),k=l[m]===">>",c=l[m+1];if(!c)return f("echo: redirection needs a file");const x=me(s.cwd,c),re=Ae(s.root,x);if(!re.node){const ae=Ue(s.root,x.substring(0,x.lastIndexOf("/")),!0).node;if(!ae)return f(`echo: cannot create file '${c}'`);ae.children.push(S(x.split("/").pop()||"file.txt",u+(k?"":`
`))),Ce(s);return}if(re.node.type!=="file")return f(`echo: ${c}: Is a directory`);re.node.content=k?re.node.content+u:u+`
`,re.node.updatedAt=Je();return}f(l.join(" "))}function O(l,f){if(!l[0])return f("touch: missing file operand");const m=me(s.cwd,l[0]),u=Ae(s.root,m);if(!u.node){const k=m.substring(0,m.lastIndexOf("/"))||"/",{node:c}=Ue(s.root,k,!0);if(!c)return f(`touch: cannot create '${l[0]}'`);c.children.push(S(m.split("/").pop()||"file.txt",""));return}if(u.node.type!=="file")return f(`touch: ${l[0]}: Is a directory`);u.node.updatedAt=Je()}function T(l,f){if(!l[0])return f("mkdir: missing operand");const m=l[0]==="-p",u=m?l[1]:l[0];if(!u)return f("mkdir: missing operand");const k=me(s.cwd,u);if(!Ue(s.root,k,m).node)return f(`mkdir: cannot create directory '${u}'`)}function L(l,f){if(!l[0])return f("rm: missing operand");const m=l[0]==="-r",u=m?l[1]:l[0],k=me(s.cwd,u);xt(s.root,k,m)||f(`rm: cannot remove '${u}'`)}function _(l){if(l.key==="Enter"){l.preventDefault();const f=h;t(3,h=""),J(f)}else l.key==="ArrowUp"?(w>0&&(w-=1,t(3,h=v[w]??"")),l.preventDefault()):l.key==="ArrowDown"?(w<v.length&&(w+=1,t(3,h=v[w]??"")),l.preventDefault()):l.key==="c"&&(l.ctrlKey||l.metaKey)?(D('<span class="prompt">'+n+"</span> "+Pe(h)),t(3,h=""),l.preventDefault()):l.key==="Tab"&&(l.preventDefault(),Z())}function j(l){const f=l.target,m=f.closest("a.cmd");if(m){l.preventDefault();const k=m.getAttribute("data-cmd")||"";k&&J(k);return}const u=f.closest("a.nav");if(u){l.preventDefault();const k=u.getAttribute("href")||"";k&&(window.location.href=k);return}P()}function A(l){const f=l.target;if(!(l.key==="Enter"||l.key===" "))return;const u=f.closest("a.cmd"),k=f.closest("a.nav");if(u){l.preventDefault();const c=u.getAttribute("data-cmd")||"";c&&J(c);return}if(k){l.preventDefault();const c=k.getAttribute("href")||"";c&&(window.location.href=c)}}jt(()=>{be(),P();const l=()=>{t(4,ee=Math.floor((Date.now()-C.getTime())/6e4))};l(),te=setInterval(l,1e4),typeof window<"u"&&window.addEventListener("persephone:save",z)}),Vt(()=>{te&&clearInterval(te),typeof window<"u"&&window.removeEventListener("persephone:save",z)});function ve(l){De.call(this,r,l)}function _e(l){De.call(this,r,l)}function Te(l){De.call(this,r,l)}function ke(l){De.call(this,r,l)}function we(l){De.call(this,r,l)}function je(l){De.call(this,r,l)}function Be(l){De.call(this,r,l)}function Oe(l){De.call(this,r,l)}function wt(l){Me[l?"unshift":"push"](()=>{a=l,t(2,a)})}function Et(){h=this.value,t(3,h)}function It(l){Me[l?"unshift":"push"](()=>{q=l,t(6,q)})}function Dt(l){Me[l?"unshift":"push"](()=>{o=l,t(1,o)})}const At=()=>t(7,V=!1),St=()=>t(8,B=!1),qt=l=>{(l.key.length===1||l.key==="/"||l.key===" ")&&P()};return r.$$.update=()=>{r.$$.dirty[0]&1&&t(11,n=`${Ve}@${ze}:${Ke(s.cwd)}$`)},[s,o,a,h,ee,F,q,V,B,K,ce,n,Y,N,le,se,P,_,j,A,ve,_e,Te,ke,we,je,Be,Oe,wt,Et,It,Dt,At,St,qt]}class Yt extends ht{constructor(e){super(),mt(this,e,Kt,Gt,pt,{},null,[-1,-1,-1])}}function Qt(r){let e,t;return e=new Yt({}),{c(){gt(e.$$.fragment)},l(n){vt(e.$$.fragment,n)},m(n,s){yt(e,n,s),t=!0},p:Ge,i(n){t||(We(e.$$.fragment,n),t=!0)},o(n){Fe(e.$$.fragment,n),t=!1},d(n){_t(e,n)}}}class $t extends ht{constructor(e){super(),mt(this,e,null,Qt,pt,{})}}export{$t as default};
