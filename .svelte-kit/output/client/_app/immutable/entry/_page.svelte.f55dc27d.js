import{S as Pt,i as Rt,s as Ot,k as w,a as G,q as H,l as y,m as _,h as b,c as M,r as J,n as d,b as ve,G as c,J as wt,K as ee,u as He,g as Je,v as Mt,d as Fe,f as zt,L as jt,M as Ze,o as Ut,N as Qt,y as Tt,z as Vt,A as Ct,O as qe,H as Ge,B as Lt,t as yt,P as Ne,w as ze,e as _t}from"../chunks/index.0cd60f9d.js";import{P as Yt,S as pe}from"../chunks/PersephoneRun.614d30f4.js";const Xe="persephone.fs.v1";function Zt(){try{localStorage.removeItem(Xe)}catch{}}function Ke(){return Date.now()}function $(r,e=[]){const t=Ke();return{name:r,type:"dir",children:e,createdAt:t,updatedAt:t}}function D(r,e=""){const t=Ke();return{name:r,type:"file",content:e,createdAt:t,updatedAt:t}}function Xt(r){return JSON.stringify(r)}function $t(r){try{return JSON.parse(r)}catch{return null}}function Be(r){try{localStorage.setItem(Xe,Xt(r))}catch{}}function en(){try{const r=localStorage.getItem(Xe);return r?$t(r):null}catch{return null}}function kt(){return{root:$("/",[$("bin",[D("ls",""),D("cat",""),D("echo",""),D("pwd",""),D("cd",""),D("ip","")]),$("usr",[$("bin",[D("node",""),D("bash","")]),$("share",[D("dict.txt","why are you looking here >:(")])]),$("var",[$("log",[D("auth.log","accepted connection"),D("kern.log","boot ok")]),$("tmp")]),$("proc",[D("cpuinfo","cpu: webasm"),D("meminfo","mem: virtual")]),$("etc",[D("hostname",`jndl
`),D("hosts",`127.0.0.1 localhost
::1 localhost
`),D("os-release",`NAME=Web
ID=web`)]),$("home",[$("alex",[D("README.md",`# Alexander Jandl

Welcome to my terminal. Try \`help\` to see commands.

Useful places:
- ~/about.txt
- ~/skills.md
- ~/projects
`),D("about.txt","Infrastructure & security focused engineer based in Bratislava. I like reliable automation, scalable systems, and cats."),D("skills.md",`- Linux, networking, network security
- AWS & Azure platform security
- Scripting: Bash, Python, Powershell, C
- Zero-trust, identity, and least privilege`),{...D("blog","Open the personal blog"),link:"/blog"},$("projects",[{...D("persephone",`personal webpage, vibecoded from scratch.
i don't know any frontend :D`),link:"https://github.com/xdsai/persephone"}]),$("socials",[{...D("github","my github profile"),link:"https://github.com/xdsai"},{...D("linkedin","my linkedin profile"),link:"https://www.linkedin.com/in/jndl/"},{...D("email","email me something nice! no nigerian princes please"),link:"mailto:alex@jndl.dev"}])])]),$("tmp")]),cwd:"/home/alex"}}function xe(r){if(!r)return"/";let e=r.replace(/\\/g,"/");e.startsWith("/")||(e="/"+e);const t=[];for(const n of e.split("/"))!n||n==="."||(n===".."?t.pop():t.push(n));return"/"+t.join("/")}function be(r,e){return!e||e==="."?xe(r):e.startsWith("/")?xe(e):xe(r+"/"+e)}function Ae(r,e){const t=xe(e).split("/").filter(Boolean);if(t.length===0)return{node:r,parent:null};let n=r,s=null,l=r;for(const a of t){if(!n)return{node:null,parent:null};const h=n.children.find(p=>p.name===a)||null;if(s=n,l=h,!h)return{node:null,parent:s};n=h.type==="dir"?h:null}return{node:l,parent:s}}function Ue(r,e,t=!1){const n=xe(e);if(n==="/")return{node:r,created:!1};const s=n.split("/").filter(Boolean);let l=r,a=!1;for(const h of s){let p=l.children.find(v=>v.name===h);if(!p){if(!t)return{node:null,created:a};p=$(h),l.children.push(p),a=!0}if(p.type!=="dir")return{node:null,created:a};l=p}return{node:l,created:a}}function tn(r,e,t=!1){const{node:n,parent:s}=Ae(r,e);if(!n||!s||n.type==="dir"&&n.children.length&&!t)return!1;const l=s.children.findIndex(a=>a.name===n.name);return l>=0&&s.children.splice(l,1),!0}function Et(r,e,t){const n=r.slice();return n[59]=e[t],n}function It(r,e,t){const n=r.slice();return n[62]=e[t],n}function St(r){let e,t=r[62].html+"";return{c(){e=w("div"),this.h()},l(n){e=y(n,"DIV",{class:!0});var s=_(e);s.forEach(b),this.h()},h(){d(e,"class","row svelte-s1qwb5")},m(n,s){ve(n,e,s),e.innerHTML=t},p(n,s){s[0]&32&&t!==(t=n[62].html+"")&&(e.innerHTML=t)},d(n){n&&b(e)}}}function Dt(r){let e,t,n,s,l,a,h,p,v,I,z,te,B;return I=new Yt({props:{src:"/story.json"}}),{c(){e=w("div"),t=w("div"),n=w("div"),s=H("NEON THIRTEEN — PERSEPHONE RUN"),l=G(),a=w("button"),h=H("×"),p=G(),v=w("div"),Tt(I.$$.fragment),this.h()},l(N){e=y(N,"DIV",{class:!0,role:!0,"aria-label":!0});var ne=_(e);t=y(ne,"DIV",{class:!0});var j=_(t);n=y(j,"DIV",{class:!0});var x=_(n);s=J(x,"NEON THIRTEEN — PERSEPHONE RUN"),x.forEach(b),l=M(j),a=y(j,"BUTTON",{class:!0,"aria-label":!0});var T=_(a);h=J(T,"×"),T.forEach(b),p=M(j),v=y(j,"DIV",{class:!0});var Q=_(v);Vt(I.$$.fragment,Q),Q.forEach(b),j.forEach(b),ne.forEach(b),this.h()},h(){d(n,"class","obartitle svelte-s1qwb5"),d(a,"class","close svelte-s1qwb5"),d(a,"aria-label","close"),d(v,"class","content svelte-s1qwb5"),d(t,"class","box svelte-s1qwb5"),d(e,"class","overlay svelte-s1qwb5"),d(e,"role","dialog"),d(e,"aria-label","persephone game")},m(N,ne){ve(N,e,ne),c(e,t),c(t,n),c(n,s),c(t,l),c(t,a),c(a,h),c(t,p),c(t,v),Ct(I,v,null),z=!0,te||(B=[ee(a,"click",r[32]),ee(t,"click",qe(r[26])),ee(t,"keydown",qe(r[27])),ee(e,"click",qe(r[24])),ee(e,"keydown",qe(r[25]))],te=!0)},p:Ge,i(N){z||(Je(I.$$.fragment,N),z=!0)},o(N){Fe(I.$$.fragment,N),z=!1},d(N){N&&b(e),Lt(I),te=!1,Ze(B)}}}function Nt(r){let e,t,n,s,l,a,h,p,v,I,z,te,B,N=JSON.stringify(r[14],null,2)+"",ne,j,x,T,Q,ue,Y,A,U,F,oe,se,we,q,me;function le(K,Z){return K[9]?rn:nn}let de=le(r),P=de(r);return{c(){e=w("div"),t=w("div"),n=w("div"),s=H("Signal Bloom — ARG Panel"),l=G(),a=w("button"),h=H("×"),p=G(),v=w("div"),I=w("div"),z=H("Steganographic shards"),te=G(),B=w("pre"),ne=H(N),j=G(),x=w("div"),T=w("div"),Q=H("Discovered lore"),ue=G(),P.c(),Y=G(),A=w("div"),U=w("a"),F=H("Resume Story"),oe=G(),se=w("a"),we=H("Open blog entry"),this.h()},l(K){e=y(K,"DIV",{class:!0,role:!0,"aria-label":!0});var Z=_(e);t=y(Z,"DIV",{class:!0});var X=_(t);n=y(X,"DIV",{class:!0});var ye=_(n);s=J(ye,"Signal Bloom — ARG Panel"),ye.forEach(b),l=M(X),a=y(X,"BUTTON",{class:!0,"aria-label":!0});var ce=_(a);h=J(ce,"×"),ce.forEach(b),p=M(X),v=y(X,"DIV",{class:!0});var ge=_(v);I=y(ge,"DIV",{class:!0});var Pe=_(I);z=J(Pe,"Steganographic shards"),Pe.forEach(b),te=M(ge),B=y(ge,"PRE",{class:!0});var fe=_(B);ne=J(fe,N),fe.forEach(b),ge.forEach(b),j=M(X),x=y(X,"DIV",{class:!0});var V=_(x);T=y(V,"DIV",{class:!0});var R=_(T);Q=J(R,"Discovered lore"),R.forEach(b),ue=M(V),P.l(V),V.forEach(b),Y=M(X),A=y(X,"DIV",{class:!0});var L=_(A);U=y(L,"A",{class:!0,href:!0});var k=_(U);F=J(k,"Resume Story"),k.forEach(b),oe=M(L),se=y(L,"A",{class:!0,href:!0});var O=_(se);we=J(O,"Open blog entry"),O.forEach(b),L.forEach(b),X.forEach(b),Z.forEach(b),this.h()},h(){d(n,"class","obartitle svelte-s1qwb5"),d(a,"class","close svelte-s1qwb5"),d(a,"aria-label","close"),d(I,"class","arghead svelte-s1qwb5"),d(B,"class","payload svelte-s1qwb5"),d(v,"class","argsec svelte-s1qwb5"),d(T,"class","arghead svelte-s1qwb5"),d(x,"class","argsec svelte-s1qwb5"),d(U,"class","nav svelte-s1qwb5"),d(U,"href","/blog/corrections-and-clarifications#persephone"),d(se,"class","nav svelte-s1qwb5"),d(se,"href","/blog/corrections-and-clarifications"),d(A,"class","argsec links svelte-s1qwb5"),d(t,"class","box arg svelte-s1qwb5"),d(e,"class","overlay svelte-s1qwb5"),d(e,"role","dialog"),d(e,"aria-label","ARG panel")},m(K,Z){ve(K,e,Z),c(e,t),c(t,n),c(n,s),c(t,l),c(t,a),c(a,h),c(t,p),c(t,v),c(v,I),c(I,z),c(v,te),c(v,B),c(B,ne),c(t,j),c(t,x),c(x,T),c(T,Q),c(x,ue),P.m(x,null),c(t,Y),c(t,A),c(A,U),c(U,F),c(A,oe),c(A,se),c(se,we),q||(me=[ee(a,"click",r[33]),ee(t,"click",qe(r[22])),ee(t,"keydown",qe(r[23])),ee(e,"click",qe(r[20])),ee(e,"keydown",qe(r[21]))],q=!0)},p(K,Z){de===(de=le(K))&&P?P.p(K,Z):(P.d(1),P=de(K),P&&(P.c(),P.m(x,null)))},d(K){K&&b(e),P.d(),q=!1,Ze(me)}}}function nn(r){let e,t;return{c(){e=w("div"),t=H("no registry"),this.h()},l(n){e=y(n,"DIV",{class:!0});var s=_(e);t=J(s,"no registry"),s.forEach(b),this.h()},h(){d(e,"class","dim")},m(n,s){ve(n,e,s),c(e,t)},p:Ge,d(n){n&&b(e)}}}function rn(r){let e;function t(l,a){var h,p,v;return(v=(p=(h=l[10])==null?void 0:h.state)==null?void 0:p.loreDiscoveries)!=null&&v.length?on:sn}let n=t(r),s=n(r);return{c(){s.c(),e=_t()},l(l){s.l(l),e=_t()},m(l,a){s.m(l,a),ve(l,e,a)},p(l,a){n===(n=t(l))&&s?s.p(l,a):(s.d(1),s=n(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){s.d(l),l&&b(e)}}}function sn(r){let e,t;return{c(){e=w("div"),t=H("no lore discovered"),this.h()},l(n){e=y(n,"DIV",{class:!0});var s=_(e);t=J(s,"no lore discovered"),s.forEach(b),this.h()},h(){d(e,"class","dim")},m(n,s){ve(n,e,s),c(e,t)},p:Ge,d(n){n&&b(e)}}}function on(r){let e,t=r[15](r[10]),n=[];for(let s=0;s<t.length;s+=1)n[s]=qt(Et(r,t,s));return{c(){e=w("ul");for(let s=0;s<n.length;s+=1)n[s].c()},l(s){e=y(s,"UL",{});var l=_(e);for(let a=0;a<n.length;a+=1)n[a].l(l);l.forEach(b)},m(s,l){ve(s,e,l);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(s,l){if(l[0]&33792){t=s[15](s[10]);let a;for(a=0;a<t.length;a+=1){const h=Et(s,t,a);n[a]?n[a].p(h,l):(n[a]=qt(h),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=t.length}},d(s){s&&b(e),jt(n,s)}}}function At(r){var l;let e,t,n=((l=r[59])==null?void 0:l.summary)+"",s;return{c(){e=w("span"),t=H("— "),s=H(n),this.h()},l(a){e=y(a,"SPAN",{class:!0});var h=_(e);t=J(h,"— "),s=J(h,n),h.forEach(b),this.h()},h(){d(e,"class","lsum svelte-s1qwb5")},m(a,h){ve(a,e,h),c(e,t),c(e,s)},p(a,h){var p;h[0]&1024&&n!==(n=((p=a[59])==null?void 0:p.summary)+"")&&He(s,n)},d(a){a&&b(e)}}}function qt(r){var a,h;let e,t,n=((a=r[59])==null?void 0:a.title)+"",s,l=((h=r[59])==null?void 0:h.summary)&&At(r);return{c(){e=w("li"),t=w("span"),s=H(n),l&&l.c(),this.h()},l(p){e=y(p,"LI",{});var v=_(e);t=y(v,"SPAN",{class:!0});var I=_(t);s=J(I,n),I.forEach(b),l&&l.l(v),v.forEach(b),this.h()},h(){d(t,"class","ltitle svelte-s1qwb5")},m(p,v){ve(p,e,v),c(e,t),c(t,s),l&&l.m(e,null)},p(p,v){var I,z;v[0]&1024&&n!==(n=((I=p[59])==null?void 0:I.title)+"")&&He(s,n),(z=p[59])!=null&&z.summary?l?l.p(p,v):(l=At(p),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(p){p&&b(e),l&&l.d()}}}function ln(r){let e,t,n,s,l,a,h,p,v,I,z,te,B=Ye(r[0].cwd)+"",N,ne,j,x,T,Q,ue,Y,A,U,F,oe,se,we,q,me,le,de,P,K,Z,X,ye,ce,ge,Pe,fe=r[5],V=[];for(let k=0;k<fe.length;k+=1)V[k]=St(It(r,fe,k));let R=r[7]&&Dt(r),L=r[8]&&Nt(r);return{c(){e=w("div"),t=w("div"),n=w("div"),s=w("span"),l=w("span"),a=w("span"),h=G(),p=w("span"),v=H(Te),I=H("@"),z=H(Qe),te=H(" — "),N=H(B),ne=G(),j=w("span"),x=H("up "),T=H(r[4]),Q=H(" min"),ue=G(),Y=w("div"),A=w("div");for(let k=0;k<V.length;k+=1)V[k].c();U=G(),F=w("div"),oe=w("span"),se=H(r[11]),we=G(),q=w("input"),me=G(),le=w("div"),de=G(),P=w("div"),K=G(),Z=w("div"),X=G(),R&&R.c(),ye=G(),L&&L.c(),this.h()},l(k){e=y(k,"DIV",{class:!0,tabindex:!0,role:!0,"aria-label":!0});var O=_(e);t=y(O,"DIV",{class:!0});var S=_(t);n=y(S,"DIV",{class:!0});var _e=_(n);s=y(_e,"SPAN",{class:!0}),_(s).forEach(b),l=y(_e,"SPAN",{class:!0}),_(l).forEach(b),a=y(_e,"SPAN",{class:!0}),_(a).forEach(b),_e.forEach(b),h=M(S),p=y(S,"SPAN",{class:!0,style:!0});var Ee=_(p);v=J(Ee,Te),I=J(Ee,"@"),z=J(Ee,Qe),te=J(Ee," — "),N=J(Ee,B),Ee.forEach(b),ne=M(S),j=y(S,"SPAN",{class:!0});var Oe=_(j);x=J(Oe,"up "),T=J(Oe,r[4]),Q=J(Oe," min"),Oe.forEach(b),S.forEach(b),ue=M(O),Y=y(O,"DIV",{class:!0});var Ie=_(Y);A=y(Ie,"DIV",{class:!0});var Se=_(A);for(let Ve=0;Ve<V.length;Ve+=1)V[Ve].l(Se);U=M(Se),F=y(Se,"DIV",{class:!0});var je=_(F);oe=y(je,"SPAN",{class:!0,"aria-hidden":!0});var We=_(oe);se=J(We,r[11]),We.forEach(b),we=M(je),q=y(je,"INPUT",{class:!0,type:!0,spellcheck:!0,autocapitalize:!0,autocomplete:!0,autocorrect:!0}),je.forEach(b),me=M(Se),le=y(Se,"DIV",{class:!0,"aria-hidden":!0}),_(le).forEach(b),Se.forEach(b),de=M(Ie),P=y(Ie,"DIV",{class:!0,"aria-hidden":!0}),_(P).forEach(b),K=M(Ie),Z=y(Ie,"DIV",{class:!0,"aria-hidden":!0}),_(Z).forEach(b),Ie.forEach(b),X=M(O),R&&R.l(O),ye=M(O),L&&L.l(O),O.forEach(b),this.h()},h(){d(s,"class","dot r svelte-s1qwb5"),d(l,"class","dot y svelte-s1qwb5"),d(a,"class","dot g svelte-s1qwb5"),d(n,"class","controls svelte-s1qwb5"),d(p,"class","title svelte-s1qwb5"),d(p,"style",`animation: glitch ${r[12].toFixed(2)}s infinite steps(2); animation-delay:${r[13].toFixed(2)}s`),d(j,"class","uptime svelte-s1qwb5"),d(t,"class","titlebar svelte-s1qwb5"),d(oe,"class","prompt svelte-s1qwb5"),d(oe,"aria-hidden","true"),d(q,"class","readline svelte-s1qwb5"),d(q,"type","text"),d(q,"spellcheck","false"),d(q,"autocapitalize","off"),d(q,"autocomplete","off"),d(q,"autocorrect","off"),d(F,"class","row input svelte-s1qwb5"),d(le,"class","end svelte-s1qwb5"),d(le,"aria-hidden","true"),d(A,"class","terminal svelte-s1qwb5"),d(P,"class","fx fx-scan svelte-s1qwb5"),d(P,"aria-hidden","true"),d(Z,"class","fx fx-noise svelte-s1qwb5"),d(Z,"aria-hidden","true"),d(Y,"class","term-pane svelte-s1qwb5"),d(e,"class","terminal-wrap svelte-s1qwb5"),d(e,"tabindex","-1"),d(e,"role","group"),d(e,"aria-label","web terminal")},m(k,O){ve(k,e,O),c(e,t),c(t,n),c(n,s),c(n,l),c(n,a),c(t,h),c(t,p),c(p,v),c(p,I),c(p,z),c(p,te),c(p,N),c(t,ne),c(t,j),c(j,x),c(j,T),c(j,Q),c(e,ue),c(e,Y),c(Y,A);for(let S=0;S<V.length;S+=1)V[S]&&V[S].m(A,null);c(A,U),c(A,F),c(F,oe),c(oe,se),c(F,we),c(F,q),r[28](q),wt(q,r[3]),c(A,me),c(A,le),r[30](le),r[31](A),c(Y,de),c(Y,P),c(Y,K),c(Y,Z),c(e,X),R&&R.m(e,null),c(e,ye),L&&L.m(e,null),ce=!0,ge||(Pe=[ee(q,"input",r[29]),ee(q,"keydown",r[17]),ee(A,"click",r[18]),ee(A,"keydown",r[19]),ee(e,"click",r[16]),ee(e,"keydown",r[34])],ge=!0)},p(k,O){if((!ce||O[0]&1)&&B!==(B=Ye(k[0].cwd)+"")&&He(N,B),(!ce||O[0]&16)&&He(T,k[4]),O[0]&32){fe=k[5];let S;for(S=0;S<fe.length;S+=1){const _e=It(k,fe,S);V[S]?V[S].p(_e,O):(V[S]=St(_e),V[S].c(),V[S].m(A,U))}for(;S<V.length;S+=1)V[S].d(1);V.length=fe.length}(!ce||O[0]&2048)&&He(se,k[11]),O[0]&8&&q.value!==k[3]&&wt(q,k[3]),k[7]?R?(R.p(k,O),O[0]&128&&Je(R,1)):(R=Dt(k),R.c(),Je(R,1),R.m(e,ye)):R&&(Mt(),Fe(R,1,1,()=>{R=null}),zt()),k[8]?L?L.p(k,O):(L=Nt(k),L.c(),L.m(e,null)):L&&(L.d(1),L=null)},i(k){ce||(Je(R),ce=!0)},o(k){Fe(R),ce=!1},d(k){k&&b(e),jt(V,k),r[28](null),r[30](null),r[31](null),R&&R.d(),L&&L.d(),ge=!1,Ze(Pe)}}}let Qe="jndl",Te="alex";function Ye(r){const e="/home/"+Te;return r===e?"~":r.startsWith(e+"/")?"~"+r.slice(e.length):r}function an(r){const e=[];let t="",n=!1;for(let s=0;s<r.length;s++){const l=r[s];if(l==='"'){n=!n;continue}if(!n&&/\s/.test(l)){t&&(e.push(t),t="");continue}t+=l}return t&&e.push(t),e}function Re(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function cn(r){return r==="~"||r.startsWith("~/")?"/home/"+Te+(r.length>1?r.slice(1):""):r}function un(r){if(!r.length)return"";let e=r[0];for(const t of r.slice(1)){let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;if(e=e.slice(0,n),!e)break}return e}function*Ht(r,e){for(const t of r.children){const n=t.type==="dir";yield`${e}${t.name}${n?"/":""}`,n&&(yield*Ht(t,e+"  "))}}function dn(r,e,t){let n,s=kt(),l,a,h="",p=[],v=-1;const I=new Date;let z=0,te=null,B=[],N;const ne={help:"help — list available commands",ls:"ls [path] — list directory contents (click names to open)",tree:"tree [path] — show directory tree",pwd:"pwd — print working directory",cd:"cd <path> — change directory",cat:"cat <file> — print file to terminal",echo:'echo "text" > file — write or append with >>',touch:"touch <file> — create an empty file",mkdir:"mkdir [-p] <dir> — create directory",rm:"rm [-r] <path> — remove file or directory",clear:"clear — clear the screen",whoami:"whoami — print current user",date:"date — print current date/time",uname:"uname — print kernel info",ip:"ip — print public IP address",man:"man <cmd> — show a short description",resetfs:"resetfs — reset filesystem to defaults (clears local storage)",play:"play — open the Persephone story",save:"save — save current Persephone run",load:"load — load saved Persephone run",reset:"reset — reset Persephone run"};let j=!1,x=!1,T=null,Q=null,ue=null;const Y=4+Math.random()*4,A=Math.random()*3;function U(){try{const o=localStorage.getItem(pe);t(10,ue=o?JSON.parse(o):null)}catch{t(10,ue=null)}}async function F(){var o,f;if(!T){try{const g=await fetch("/story.json");if(g.ok){const u=await g.json();T=u.meta||null,t(9,Q=((o=u.meta)==null?void 0:o.loreRegistry)||null);return}}catch{}try{const u=await(await fetch("/assets/persephone-run.json")).json();T=u.meta||null,t(9,Q=((f=u.meta)==null?void 0:f.loreRegistry)||null)}catch{}}}const oe={status:"decrypted",shards:6,hint:"six seeds bloom a signal",routes:["/blog/welcome","/"]};function se(o){var f;try{const g=((f=o==null?void 0:o.state)==null?void 0:f.loreDiscoveries)||[];return!Array.isArray(g)||!Q?[]:g.map(u=>Q.find(E=>E.slug===u)).filter(Boolean)}catch{return[]}}function we(){const o=en();o?t(0,s=o):Be(s),P('<span class="g">Welcome</span> — type <span class="y">help</span> to get started.'),P(`<div class="onboard">Quick start:
      <a href="#" class="cmd" data-cmd="ls">list files</a>
      · <a href="#" class="cmd" data-cmd="play">play the story</a>
      · <a href="/blog" class="nav">blog</a>
      <div class="hint">Tip: use <b>ls</b> to list, <b>cat &lt;file&gt;</b> to read, <b>cd &lt;dir&gt;</b> to open</div>
    </div>`)}function q(){a==null||a.focus()}let me=null;function le(o=3){!l||l.scrollHeight-l.scrollTop-l.clientHeight<2||(t(1,l.scrollTop=l.scrollHeight,l),o>0&&requestAnimationFrame(()=>le(o-1)))}function de(){N!=null&&N.scrollIntoView&&N.scrollIntoView({block:"end"}),me&&cancelAnimationFrame(me),me=requestAnimationFrame(()=>le(2))}function P(o){t(5,B=[...B,{html:o}]),yt().then(()=>{de()})}async function K(o){var W,re,ae,Ce,De,$e,et,tt,nt,rt,st,ot,lt,at,it,ct,ut,dt,ft,ht,pt,mt,gt;const f=o.trim();if(P(`<span class="cmdline"><span class="prompt">${Re(n)}</span> <span class="cmdtext">${Re(o)}</span></span>`),!f)return;p.push(o),v=p.length;const[g,...u]=an(f),E=[],i=(ke,he=!1)=>E.push({text:ke,raw:he});try{const ke=(g||"").toLowerCase(),he=u.map(C=>(C||"").toLowerCase());switch(ke){case"help":i(Object.keys(ne).join(", "));break;case"pwd":i(s.cwd);break;case"whoami":i(Te);break;case"date":i(new Date().toString());break;case"uname":i("Linux persephone 6.1.0 x86_64 (web)");break;case"ip":{try{const m=await(await fetch("https://api.ipify.org?format=json",{cache:"no-store"})).json();i(`public: ${m.ip}`)}catch{i("ip: unable to fetch external IP")}break}case"clear":t(5,B=[]),await yt(),de(),q();break;case"cd":ye(u,i);break;case"ls":ce(u,i);break;case"tree":ge(u,i);break;case"cat":Pe(u,i);break;case"echo":fe(u,i);break;case"touch":V(u,i);break;case"mkdir":R(u,i);break;case"rm":L(u,i);break;case"resetfs":{Zt(),t(0,s=kt()),Be(s),i("filesystem reset to defaults");break}case"man":{const C=u[0];if(!C){i("man: missing command");break}const m=ne[C];i(m||`No manual entry for ${C}`);break}case"play":{await F(),t(7,j=!0),i("opening game…");break}case"save":{i("persephone: auto-saved (if a run is in progress).");break}case"load":{if(!!!localStorage.getItem(pe)){i("persephone: no save found");break}t(7,j=!0),i("persephone: loaded (open window).");break}case"reset":{localStorage.removeItem(pe),i("persephone: save cleared");break}case"whois":{await F();const C=(he[0]||"").toLowerCase();if(C==="nine"||C==="alex")try{const m=localStorage.getItem(pe),ie=m?JSON.parse(m):null,Le=!!((re=(W=ie==null?void 0:ie.state)==null?void 0:W.flags)!=null&&re.ghostKey),bt=(T==null?void 0:T.date)||"2077-08-13",vt="Revision Night",Me=Le;i(`name: alex
nickname: went by nine
op: ${vt} ${bt}
status: ${Me?"confirmed: Redactor Crown acquired":"linked: Crown operation in progress"}
notes: ${Me?"the one who slipped into Parallax HQ and pocketed the Redactor Crown during Revision Night.":"the one who's preparing a breach on Parallax HQ to lift the Redactor Crown."}`)}catch{i(`name: alex
nickname: went by nine
notes: linked to a Redactor Crown breach on Revision Night.`)}else if(C==="johnny")try{const m=localStorage.getItem("persephone-run-v1:save"),ie=m?JSON.parse(m):null,Le=!!(((ae=ie==null?void 0:ie.state)==null?void 0:ae.loreDiscoveries)||[]).includes("johnny-silverhand");i(Le?"record shows JOHNNY S— (silver tape wrapped on right hand).":"record incomplete.")}catch{i("record incomplete.")}else i("whois: whois who?");break}case"persephone":{if(he[0]==="--bloom"){await F();try{const C=localStorage.getItem(pe);if(!C){i("no bloom: signal dormant");break}const m=JSON.parse(C);if(((De=(Ce=m==null?void 0:m.state)==null?void 0:Ce.flags)==null?void 0:De.arg_bloom_ready)===!0||!!((et=($e=m==null?void 0:m.state)==null?void 0:$e.flags)!=null&&et.blogPosted)&&((nt=(tt=m==null?void 0:m.state)==null?void 0:tt.flags)==null?void 0:nt.blogClean)===!1){t(8,x=!0),i("bloom: signal decrypted (open panel)"),U();try{m.state.flags.arg_bloom_opened=!0,localStorage.setItem(pe,JSON.stringify(m))}catch{}}else i("no bloom: signal dormant")}catch{i("no bloom: signal dormant")}}else i("persephone: unknown flag");break}case"canon":{if(he[0]==="--bloom"){await F();try{const C=localStorage.getItem(pe);if(!C){i("no bloom: signal dormant");break}const m=JSON.parse(C);if(((st=(rt=m==null?void 0:m.state)==null?void 0:rt.flags)==null?void 0:st.arg_bloom_ready)===!0||!!((lt=(ot=m==null?void 0:m.state)==null?void 0:ot.flags)!=null&&lt.blogPosted)&&((it=(at=m==null?void 0:m.state)==null?void 0:at.flags)==null?void 0:it.blogClean)===!1){t(8,x=!0),i("bloom: signal decrypted (open panel)"),U();try{m.state.flags.arg_bloom_opened=!0,localStorage.setItem(pe,JSON.stringify(m))}catch{}}else i("no bloom: signal dormant")}catch{i("no bloom: signal dormant")}}else i("canon: unknown flag");break}case"pomegranate":case"kore13":{await F();try{const C=localStorage.getItem(pe);if(!C){i("no bloom: signal dormant");break}const m=JSON.parse(C);if(((ut=(ct=m==null?void 0:m.state)==null?void 0:ct.flags)==null?void 0:ut.arg_bloom_ready)===!0||!!((ft=(dt=m==null?void 0:m.state)==null?void 0:dt.flags)!=null&&ft.blogPosted)&&((pt=(ht=m==null?void 0:m.state)==null?void 0:ht.flags)==null?void 0:pt.blogClean)===!1){t(8,x=!0),i("bloom: signal decrypted (open panel)"),U();try{m.state.flags.arg_bloom_opened=!0,localStorage.setItem(pe,JSON.stringify(m))}catch{}}else i("no bloom: signal dormant")}catch{i("no bloom: signal dormant")}break}default:if(ke+" "+(he[0]||"")=="whois nine"||ke+" "+(he[0]||"")=="whois alex"){await F();try{const C=localStorage.getItem(pe),m=C?JSON.parse(C):null,ie=!!((gt=(mt=m==null?void 0:m.state)==null?void 0:mt.flags)!=null&&gt.ghostKey),Le=(T==null?void 0:T.date)||"2077-08-13";i(`name: alex
nickname: went by nine
op: revision night ${Le}
status: ${ie?"confirmed: Crown acquired":"linked: Crown operation in progress"}
notes: ${ie?"the one who slipped into Parallax HQ and pocketed the Redactor Crown during Revision Night.":"the one who's preparing a breach on Parallax HQ to lift the Redactor Crown."}`)}catch{i(`name: alex
nickname: went by nine
notes: linked to a Redactor Crown breach on Revision Night.`)}}else i(`${g}: command not found`)}}catch(ke){i(String(ke))}if(E.length){const ke=E.map(he=>he.raw?he.text:Re(he.text)).join(`
`);P(ke)}Be(s)}function Z(o){const f=cn(o),g=f.startsWith("/")?f:be(s.cwd,f),u=g.endsWith("/"),E=u?g:g.substring(0,g.lastIndexOf("/")>=0?g.lastIndexOf("/"):0),i=u?"":g.split("/").pop()||"",W=Ae(s.root,E||"/").node;if(!W||W.type!=="dir")return{next:null,suggestions:[]};const ae=W.children.map(De=>De.type==="dir"?De.name+"/":De.name).filter(De=>De.startsWith(i));if(ae.length===0)return{next:null,suggestions:[]};if(ae.length===1)return{next:u?g:E+"/"+ae[0],suggestions:ae};const Ce=un(ae);return Ce.length>i.length?{next:E+"/"+Ce,suggestions:ae}:{next:null,suggestions:ae}}function X(){let o=!1,f=-1;for(let W=0;W<h.length;W++){const re=h[W];re==='"'&&(o=!o),!o&&/\s/.test(re)&&(f=W)}const g=h.slice(0,f+1),u=h.slice(f+1);if(!u)return;const{next:E,suggestions:i}=Z(u);if(E){const W=E.startsWith(s.cwd)?E.replace(s.cwd,"").replace(/^\//,""):E;t(3,h=g+W);return}i.length&&P(i.join("  "))}function ye(o,f){const g=be(s.cwd,o[0]??"/"),u=Ae(s.root,g);if(!u.node)return f(`cd: no such file or directory: ${o[0]??"/"}`);if(u.node.type!=="dir")return f(`cd: not a directory: ${o[0]}`);t(0,s.cwd=g,s)}function ce(o,f){const g=be(s.cwd,o[0]??"."),{node:u}=Ae(s.root,g);if(!u)return f(`ls: cannot access '${o[0]??"."}': No such file or directory`);if(u.type==="file")return f(u.name);be("/",g);const E=u.children.map(i=>{const W=i.type==="dir"?i.name+"/":i.name;if(i.type==="dir")return Re(W);const re=i;return re.link?`<a href="${re.link}" class="nav">${Re(W)}</a>`:Re(W)}).join("  ");f(E,!0)}function ge(o,f){const g=be(s.cwd,o[0]??"."),{node:u}=Ae(s.root,g);if(!u)return f(`tree: ${o[0]??"."}: No such file or directory`);if(u.type==="file")return f(u.name);f(u.name||"/"),f([...Ht(u,"  ")].join(`
`))}function Pe(o,f){if(!o[0])return f("cat: missing file operand");const g=be(s.cwd,o[0]),{node:u}=Ae(s.root,g);if(!u)return f(`cat: ${o[0]}: No such file or directory`);if(u.type!=="file")return f(`cat: ${o[0]}: Is a directory`);f(u.content)}function fe(o,f){const g=o.findIndex(u=>u===">"||u===">>");if(g>=0){const u=o.slice(0,g).join(" "),E=o[g]===">>",i=o[g+1];if(!i)return f("echo: redirection needs a file");const W=be(s.cwd,i),re=Ae(s.root,W);if(!re.node){const ae=Ue(s.root,W.substring(0,W.lastIndexOf("/")),!0).node;if(!ae)return f(`echo: cannot create file '${i}'`);ae.children.push(D(W.split("/").pop()||"file.txt",u+(E?"":`
`))),Be(s);return}if(re.node.type!=="file")return f(`echo: ${i}: Is a directory`);re.node.content=E?re.node.content+u:u+`
`,re.node.updatedAt=Ke();return}f(o.join(" "))}function V(o,f){if(!o[0])return f("touch: missing file operand");const g=be(s.cwd,o[0]),u=Ae(s.root,g);if(!u.node){const E=g.substring(0,g.lastIndexOf("/"))||"/",{node:i}=Ue(s.root,E,!0);if(!i)return f(`touch: cannot create '${o[0]}'`);i.children.push(D(g.split("/").pop()||"file.txt",""));return}if(u.node.type!=="file")return f(`touch: ${o[0]}: Is a directory`);u.node.updatedAt=Ke()}function R(o,f){if(!o[0])return f("mkdir: missing operand");const g=o[0]==="-p",u=g?o[1]:o[0];if(!u)return f("mkdir: missing operand");const E=be(s.cwd,u);if(!Ue(s.root,E,g).node)return f(`mkdir: cannot create directory '${u}'`)}function L(o,f){if(!o[0])return f("rm: missing operand");const g=o[0]==="-r",u=g?o[1]:o[0],E=be(s.cwd,u);tn(s.root,E,g)||f(`rm: cannot remove '${u}'`)}function k(o){if(o.key==="Enter"){o.preventDefault();const f=h;t(3,h=""),K(f)}else o.key==="ArrowUp"?(v>0&&(v-=1,t(3,h=p[v]??"")),o.preventDefault()):o.key==="ArrowDown"?(v<p.length&&(v+=1,t(3,h=p[v]??"")),o.preventDefault()):o.key==="c"&&(o.ctrlKey||o.metaKey)?(P('<span class="prompt">'+n+"</span> "+Re(h)),t(3,h=""),o.preventDefault()):o.key==="Tab"&&(o.preventDefault(),X())}function O(o){const f=o.target,g=f.closest("a.cmd");if(g){o.preventDefault();const E=g.getAttribute("data-cmd")||"";E&&K(E);return}const u=f.closest("a.nav");if(u){o.preventDefault();const E=u.getAttribute("href")||"";E&&(window.location.href=E);return}q()}function S(o){const f=o.target;if(!(o.key==="Enter"||o.key===" "))return;const u=f.closest("a.cmd"),E=f.closest("a.nav");if(u){o.preventDefault();const i=u.getAttribute("data-cmd")||"";i&&K(i);return}if(E){o.preventDefault();const i=E.getAttribute("href")||"";i&&(window.location.href=i)}}Ut(()=>{we(),q();const o=()=>{t(4,z=Math.floor((Date.now()-I.getTime())/6e4))};o(),te=setInterval(o,1e4),typeof window<"u"&&window.addEventListener("persephone:save",U)}),Qt(()=>{te&&clearInterval(te),typeof window<"u"&&window.removeEventListener("persephone:save",U)});function _e(o){Ne.call(this,r,o)}function Ee(o){Ne.call(this,r,o)}function Oe(o){Ne.call(this,r,o)}function Ie(o){Ne.call(this,r,o)}function Se(o){Ne.call(this,r,o)}function je(o){Ne.call(this,r,o)}function We(o){Ne.call(this,r,o)}function Ve(o){Ne.call(this,r,o)}function Jt(o){ze[o?"unshift":"push"](()=>{a=o,t(2,a)})}function xt(){h=this.value,t(3,h)}function Wt(o){ze[o?"unshift":"push"](()=>{N=o,t(6,N)})}function Bt(o){ze[o?"unshift":"push"](()=>{l=o,t(1,l)})}const Ft=()=>t(7,j=!1),Kt=()=>t(8,x=!1),Gt=o=>{(o.key.length===1||o.key==="/"||o.key===" ")&&q()};return r.$$.update=()=>{r.$$.dirty[0]&1&&t(11,n=`${Te}@${Qe}:${Ye(s.cwd)}$`)},[s,l,a,h,z,B,N,j,x,Q,ue,n,Y,A,oe,se,q,k,O,S,_e,Ee,Oe,Ie,Se,je,We,Ve,Jt,xt,Wt,Bt,Ft,Kt,Gt]}class fn extends Pt{constructor(e){super(),Rt(this,e,dn,ln,Ot,{},null,[-1,-1,-1])}}function hn(r){let e,t;return e=new fn({}),{c(){Tt(e.$$.fragment)},l(n){Vt(e.$$.fragment,n)},m(n,s){Ct(e,n,s),t=!0},p:Ge,i(n){t||(Je(e.$$.fragment,n),t=!0)},o(n){Fe(e.$$.fragment,n),t=!1},d(n){Lt(e,n)}}}class vn extends Pt{constructor(e){super(),Rt(this,e,null,hn,Ot,{})}}export{vn as default};
