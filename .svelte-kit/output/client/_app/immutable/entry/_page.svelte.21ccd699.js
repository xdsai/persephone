import{S as ut,i as dt,s as ft,k as v,a as z,q as V,l as b,m as k,h as m,c as K,r as R,n as f,b as pe,G as i,J as Xe,K as Z,u as Le,g as xe,v as Dt,d as Ce,f as St,L as ht,M as Ke,o as At,N as Nt,y as pt,z as mt,A as gt,O as Ie,H as Ge,B as vt,t as Pt,P as we,w as $e,e as et}from"../chunks/index.0cd60f9d.js";import{P as Tt,S as Re}from"../chunks/PersephoneRun.d1c6982d.js";const Fe="persephone.fs.v1";function jt(){try{localStorage.removeItem(Fe)}catch{}}function Je(){return Date.now()}function Q(s,e=[]){const t=Je();return{name:s,type:"dir",children:e,createdAt:t,updatedAt:t}}function N(s,e=""){const t=Je();return{name:s,type:"file",content:e,createdAt:t,updatedAt:t}}function Ot(s){return JSON.stringify(s)}function Vt(s){try{return JSON.parse(s)}catch{return null}}function Be(s){try{localStorage.setItem(Fe,Ot(s))}catch{}}function Rt(){try{const s=localStorage.getItem(Fe);return s?Vt(s):null}catch{return null}}function tt(){return{root:Q("/",[Q("bin",[N("ls",""),N("cat",""),N("echo",""),N("pwd",""),N("cd",""),N("ip","")]),Q("usr",[Q("bin",[N("node",""),N("bash","")]),Q("share",[N("dict.txt","why are you looking here >:(")])]),Q("var",[Q("log",[N("auth.log","accepted connection"),N("kern.log","boot ok")]),Q("tmp")]),Q("proc",[N("cpuinfo","cpu: webasm"),N("meminfo","mem: virtual")]),Q("etc",[N("hostname",`jndl
`),N("hosts",`127.0.0.1 localhost
::1 localhost
`),N("os-release",`NAME=Web
ID=web`)]),Q("home",[Q("alex",[N("README.md",`# Alexander Jandl

Welcome to my terminal. Try \`help\` to see commands.

Useful places:
- ~/about.txt
- ~/skills.md
- ~/projects
`),N("about.txt","Infrastructure & security focused engineer based in Bratislava. I like reliable automation, scalable systems, and cats."),N("skills.md",`- Linux, networking, network security
- AWS & Azure platform security
- Scripting: Bash, Python, Powershell, C
- Zero-trust, identity, and least privilege`),{...N("blog","Open the personal blog"),link:"/blog"},Q("projects",[{...N("persephone",`personal webpage, vibecoded from scratch.
i don't know any frontend :D`),link:"https://github.com/xdsai/persephone"}]),Q("socials",[{...N("github","my github profile"),link:"https://github.com/xdsai"},{...N("linkedin","my linkedin profile"),link:"https://www.linkedin.com/in/jndl/"},{...N("email","email me something nice! no nigerian princes please"),link:"mailto:alex@jndl.dev"}])])]),Q("tmp")]),cwd:"/home/alex"}}function We(s){if(!s)return"/";let e=s.replace(/\\/g,"/");e.startsWith("/")||(e="/"+e);const t=[];for(const n of e.split("/"))!n||n==="."||(n===".."?t.pop():t.push(n));return"/"+t.join("/")}function he(s,e){return!e||e==="."?We(s):e.startsWith("/")?We(e):We(s+"/"+e)}function Ee(s,e){const t=We(e).split("/").filter(Boolean);if(t.length===0)return{node:s,parent:null};let n=s,r=null,a=s;for(const o of t){if(!n)return{node:null,parent:null};const h=n.children.find(g=>g.name===o)||null;if(r=n,a=h,!h)return{node:null,parent:r};n=h.type==="dir"?h:null}return{node:a,parent:r}}function Me(s,e,t=!1){const n=We(e);if(n==="/")return{node:s,created:!1};const r=n.split("/").filter(Boolean);let a=s,o=!1;for(const h of r){let g=a.children.find(w=>w.name===h);if(!g){if(!t)return{node:null,created:o};g=Q(h),a.children.push(g),o=!0}if(g.type!=="dir")return{node:null,created:o};a=g}return{node:a,created:o}}function Lt(s,e,t=!1){const{node:n,parent:r}=Ee(s,e);if(!n||!r||n.type==="dir"&&n.children.length&&!t)return!1;const a=r.children.findIndex(o=>o.name===n.name);return a>=0&&r.children.splice(a,1),!0}function nt(s,e,t){const n=s.slice();return n[55]=e[t],n}function st(s,e,t){const n=s.slice();return n[58]=e[t],n}function rt(s){let e,t=s[58].html+"";return{c(){e=v("div"),this.h()},l(n){e=b(n,"DIV",{class:!0});var r=k(e);r.forEach(m),this.h()},h(){f(e,"class","row svelte-123sck5")},m(n,r){pe(n,e,r),e.innerHTML=t},p(n,r){r[0]&32&&t!==(t=n[58].html+"")&&(e.innerHTML=t)},d(n){n&&m(e)}}}function lt(s){let e,t,n,r,a,o,h,g,w,H,X,$,B;return H=new Tt({props:{src:"/story.json"}}),{c(){e=v("div"),t=v("div"),n=v("div"),r=V("NEON THIRTEEN — PERSEPHONE RUN"),a=z(),o=v("button"),h=V("×"),g=z(),w=v("div"),pt(H.$$.fragment),this.h()},l(C){e=b(C,"DIV",{class:!0,role:!0,"aria-label":!0});var F=k(e);t=b(F,"DIV",{class:!0});var T=k(t);n=b(T,"DIV",{class:!0});var D=k(n);r=R(D,"NEON THIRTEEN — PERSEPHONE RUN"),D.forEach(m),a=K(T),o=b(T,"BUTTON",{class:!0,"aria-label":!0});var J=k(o);h=R(J,"×"),J.forEach(m),g=K(T),w=b(T,"DIV",{class:!0});var te=k(w);mt(H.$$.fragment,te),te.forEach(m),T.forEach(m),F.forEach(m),this.h()},h(){f(n,"class","obartitle svelte-123sck5"),f(o,"class","close svelte-123sck5"),f(o,"aria-label","close"),f(w,"class","content svelte-123sck5"),f(t,"class","box svelte-123sck5"),f(e,"class","overlay svelte-123sck5"),f(e,"role","dialog"),f(e,"aria-label","persephone game")},m(C,F){pe(C,e,F),i(e,t),i(t,n),i(n,r),i(t,a),i(t,o),i(o,h),i(t,g),i(t,w),gt(H,w,null),X=!0,$||(B=[Z(o,"click",s[30]),Z(t,"click",Ie(s[25])),Z(t,"keydown",Ie(s[26])),Z(e,"click",Ie(s[23])),Z(e,"keydown",Ie(s[24]))],$=!0)},p:Ge,i(C){X||(xe(H.$$.fragment,C),X=!0)},o(C){Ce(H.$$.fragment,C),X=!1},d(C){C&&m(e),vt(H),$=!1,Ke(B)}}}function ot(s){let e,t,n,r,a,o,h,g,w,H,X,$,B,C=JSON.stringify(s[13],null,2)+"",F,T,D,J,te,me,Y,A,U,ne,oe,se,de,W,re;function ae(q,le){return q[8]?Wt:xt}let fe=ae(s),G=fe(s);return{c(){e=v("div"),t=v("div"),n=v("div"),r=V("Signal Bloom — ARG Panel"),a=z(),o=v("button"),h=V("×"),g=z(),w=v("div"),H=v("div"),X=V("Steganographic shards"),$=z(),B=v("pre"),F=V(C),T=z(),D=v("div"),J=v("div"),te=V("Discovered lore"),me=z(),G.c(),Y=z(),A=v("div"),U=v("a"),ne=V("Resume Story"),oe=z(),se=v("a"),de=V("Open blog entry"),this.h()},l(q){e=b(q,"DIV",{class:!0,role:!0,"aria-label":!0});var le=k(e);t=b(le,"DIV",{class:!0});var M=k(t);n=b(M,"DIV",{class:!0});var ve=k(n);r=R(ve,"Signal Bloom — ARG Panel"),ve.forEach(m),a=K(M),o=b(M,"BUTTON",{class:!0,"aria-label":!0});var De=k(o);h=R(De,"×"),De.forEach(m),g=K(M),w=b(M,"DIV",{class:!0});var ie=k(w);H=b(ie,"DIV",{class:!0});var L=k(H);X=R(L,"Steganographic shards"),L.forEach(m),$=K(ie),B=b(ie,"PRE",{class:!0});var P=k(B);F=R(P,C),P.forEach(m),ie.forEach(m),T=K(M),D=b(M,"DIV",{class:!0});var O=k(D);J=b(O,"DIV",{class:!0});var y=k(J);te=R(y,"Discovered lore"),y.forEach(m),me=K(O),G.l(O),O.forEach(m),Y=K(M),A=b(M,"DIV",{class:!0});var S=k(A);U=b(S,"A",{class:!0,href:!0});var I=k(U);ne=R(I,"Resume Story"),I.forEach(m),oe=K(S),se=b(S,"A",{class:!0,href:!0});var ue=k(se);de=R(ue,"Open blog entry"),ue.forEach(m),S.forEach(m),M.forEach(m),le.forEach(m),this.h()},h(){f(n,"class","obartitle svelte-123sck5"),f(o,"class","close svelte-123sck5"),f(o,"aria-label","close"),f(H,"class","arghead svelte-123sck5"),f(B,"class","payload svelte-123sck5"),f(w,"class","argsec svelte-123sck5"),f(J,"class","arghead svelte-123sck5"),f(D,"class","argsec svelte-123sck5"),f(U,"class","nav svelte-123sck5"),f(U,"href","/blog/neon-thirteen-persephone-run#persephone"),f(se,"class","nav svelte-123sck5"),f(se,"href","/blog/neon-thirteen-persephone-run"),f(A,"class","argsec links svelte-123sck5"),f(t,"class","box arg svelte-123sck5"),f(e,"class","overlay svelte-123sck5"),f(e,"role","dialog"),f(e,"aria-label","ARG panel")},m(q,le){pe(q,e,le),i(e,t),i(t,n),i(n,r),i(t,a),i(t,o),i(o,h),i(t,g),i(t,w),i(w,H),i(H,X),i(w,$),i(w,B),i(B,F),i(t,T),i(t,D),i(D,J),i(J,te),i(D,me),G.m(D,null),i(t,Y),i(t,A),i(A,U),i(U,ne),i(A,oe),i(A,se),i(se,de),W||(re=[Z(o,"click",s[31]),Z(t,"click",Ie(s[21])),Z(t,"keydown",Ie(s[22])),Z(e,"click",Ie(s[19])),Z(e,"keydown",Ie(s[20]))],W=!0)},p(q,le){fe===(fe=ae(q))&&G?G.p(q,le):(G.d(1),G=fe(q),G&&(G.c(),G.m(D,null)))},d(q){q&&m(e),G.d(),W=!1,Ke(re)}}}function xt(s){let e,t;return{c(){e=v("div"),t=V("no registry"),this.h()},l(n){e=b(n,"DIV",{class:!0});var r=k(e);t=R(r,"no registry"),r.forEach(m),this.h()},h(){f(e,"class","dim")},m(n,r){pe(n,e,r),i(e,t)},p:Ge,d(n){n&&m(e)}}}function Wt(s){let e;function t(a,o){var h,g,w;return(w=(g=(h=a[9])==null?void 0:h.state)==null?void 0:g.loreDiscoveries)!=null&&w.length?Bt:Ht}let n=t(s),r=n(s);return{c(){r.c(),e=et()},l(a){r.l(a),e=et()},m(a,o){r.m(a,o),pe(a,e,o)},p(a,o){n===(n=t(a))&&r?r.p(a,o):(r.d(1),r=n(a),r&&(r.c(),r.m(e.parentNode,e)))},d(a){r.d(a),a&&m(e)}}}function Ht(s){let e,t;return{c(){e=v("div"),t=V("no lore discovered"),this.h()},l(n){e=b(n,"DIV",{class:!0});var r=k(e);t=R(r,"no lore discovered"),r.forEach(m),this.h()},h(){f(e,"class","dim")},m(n,r){pe(n,e,r),i(e,t)},p:Ge,d(n){n&&m(e)}}}function Bt(s){let e,t=s[14](s[9]),n=[];for(let r=0;r<t.length;r+=1)n[r]=it(nt(s,t,r));return{c(){e=v("ul");for(let r=0;r<n.length;r+=1)n[r].c()},l(r){e=b(r,"UL",{});var a=k(e);for(let o=0;o<n.length;o+=1)n[o].l(a);a.forEach(m)},m(r,a){pe(r,e,a);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(r,a){if(a[0]&16896){t=r[14](r[9]);let o;for(o=0;o<t.length;o+=1){const h=nt(r,t,o);n[o]?n[o].p(h,a):(n[o]=it(h),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(r){r&&m(e),ht(n,r)}}}function at(s){let e,t,n=s[55].summary+"",r;return{c(){e=v("span"),t=V("— "),r=V(n),this.h()},l(a){e=b(a,"SPAN",{class:!0});var o=k(e);t=R(o,"— "),r=R(o,n),o.forEach(m),this.h()},h(){f(e,"class","lsum svelte-123sck5")},m(a,o){pe(a,e,o),i(e,t),i(e,r)},p(a,o){o[0]&512&&n!==(n=a[55].summary+"")&&Le(r,n)},d(a){a&&m(e)}}}function it(s){let e,t,n=s[55].title+"",r,a=s[55].summary&&at(s);return{c(){e=v("li"),t=v("span"),r=V(n),a&&a.c(),this.h()},l(o){e=b(o,"LI",{});var h=k(e);t=b(h,"SPAN",{class:!0});var g=k(t);r=R(g,n),g.forEach(m),a&&a.l(h),h.forEach(m),this.h()},h(){f(t,"class","ltitle svelte-123sck5")},m(o,h){pe(o,e,h),i(e,t),i(t,r),a&&a.m(e,null)},p(o,h){h[0]&512&&n!==(n=o[55].title+"")&&Le(r,n),o[55].summary?a?a.p(o,h):(a=at(o),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(o){o&&m(e),a&&a.d()}}}function Ct(s){let e,t,n,r,a,o,h,g,w,H,X,$,B=ze(s[0].cwd)+"",C,F,T,D,J,te,me,Y,A,U,ne,oe,se,de,W,re,ae,fe,G,q,le,M,ve,De,ie=s[5],L=[];for(let y=0;y<ie.length;y+=1)L[y]=rt(st(s,ie,y));let P=s[6]&&lt(s),O=s[7]&&ot(s);return{c(){e=v("div"),t=v("div"),n=v("div"),r=v("span"),a=v("span"),o=v("span"),h=z(),g=v("span"),w=V(je),H=V("@"),X=V(Ue),$=V(" — "),C=V(B),F=z(),T=v("span"),D=V("up "),J=V(s[4]),te=V(" min"),me=z(),Y=v("div"),A=v("div");for(let y=0;y<L.length;y+=1)L[y].c();U=z(),ne=v("div"),oe=v("span"),se=V(s[10]),de=z(),W=v("input"),re=z(),ae=v("div"),fe=z(),G=v("div"),q=z(),P&&P.c(),le=z(),O&&O.c(),this.h()},l(y){e=b(y,"DIV",{class:!0,tabindex:!0,role:!0,"aria-label":!0});var S=k(e);t=b(S,"DIV",{class:!0});var I=k(t);n=b(I,"DIV",{class:!0});var ue=k(n);r=b(ue,"SPAN",{class:!0}),k(r).forEach(m),a=b(ue,"SPAN",{class:!0}),k(a).forEach(m),o=b(ue,"SPAN",{class:!0}),k(o).forEach(m),ue.forEach(m),h=K(I),g=b(I,"SPAN",{class:!0,style:!0});var be=k(g);w=R(be,je),H=R(be,"@"),X=R(be,Ue),$=R(be," — "),C=R(be,B),be.forEach(m),F=K(I),T=b(I,"SPAN",{class:!0});var Ne=k(T);D=R(Ne,"up "),J=R(Ne,s[4]),te=R(Ne," min"),Ne.forEach(m),I.forEach(m),me=K(S),Y=b(S,"DIV",{class:!0});var ke=k(Y);A=b(ke,"DIV",{class:!0});var Pe=k(A);for(let Oe=0;Oe<L.length;Oe+=1)L[Oe].l(Pe);U=K(Pe),ne=b(Pe,"DIV",{class:!0});var Te=k(ne);oe=b(Te,"SPAN",{class:!0,"aria-hidden":!0});var He=k(oe);se=R(He,s[10]),He.forEach(m),de=K(Te),W=b(Te,"INPUT",{class:!0,type:!0,spellcheck:!0,autocapitalize:!0,autocomplete:!0,autocorrect:!0}),Te.forEach(m),Pe.forEach(m),re=K(ke),ae=b(ke,"DIV",{class:!0,"aria-hidden":!0}),k(ae).forEach(m),fe=K(ke),G=b(ke,"DIV",{class:!0,"aria-hidden":!0}),k(G).forEach(m),ke.forEach(m),q=K(S),P&&P.l(S),le=K(S),O&&O.l(S),S.forEach(m),this.h()},h(){f(r,"class","dot r svelte-123sck5"),f(a,"class","dot y svelte-123sck5"),f(o,"class","dot g svelte-123sck5"),f(n,"class","controls svelte-123sck5"),f(g,"class","title svelte-123sck5"),f(g,"style",`animation: glitch ${s[11].toFixed(2)}s infinite steps(2); animation-delay:${s[12].toFixed(2)}s`),f(T,"class","uptime svelte-123sck5"),f(t,"class","titlebar svelte-123sck5"),f(oe,"class","prompt svelte-123sck5"),f(oe,"aria-hidden","true"),f(W,"class","readline svelte-123sck5"),f(W,"type","text"),f(W,"spellcheck","false"),f(W,"autocapitalize","off"),f(W,"autocomplete","off"),f(W,"autocorrect","off"),f(ne,"class","row input svelte-123sck5"),f(A,"class","terminal svelte-123sck5"),f(ae,"class","fx fx-scan svelte-123sck5"),f(ae,"aria-hidden","true"),f(G,"class","fx fx-noise svelte-123sck5"),f(G,"aria-hidden","true"),f(Y,"class","term-pane svelte-123sck5"),f(e,"class","terminal-wrap svelte-123sck5"),f(e,"tabindex","0"),f(e,"role","group"),f(e,"aria-label","web terminal")},m(y,S){pe(y,e,S),i(e,t),i(t,n),i(n,r),i(n,a),i(n,o),i(t,h),i(t,g),i(g,w),i(g,H),i(g,X),i(g,$),i(g,C),i(t,F),i(t,T),i(T,D),i(T,J),i(T,te),i(e,me),i(e,Y),i(Y,A);for(let I=0;I<L.length;I+=1)L[I]&&L[I].m(A,null);i(A,U),i(A,ne),i(ne,oe),i(oe,se),i(ne,de),i(ne,W),s[27](W),Xe(W,s[3]),s[29](A),i(Y,re),i(Y,ae),i(Y,fe),i(Y,G),i(e,q),P&&P.m(e,null),i(e,le),O&&O.m(e,null),M=!0,ve||(De=[Z(W,"input",s[28]),Z(W,"keydown",s[16]),Z(A,"click",s[17]),Z(A,"keydown",s[18]),Z(e,"click",s[15]),Z(e,"keydown",s[32])],ve=!0)},p(y,S){if((!M||S[0]&1)&&B!==(B=ze(y[0].cwd)+"")&&Le(C,B),(!M||S[0]&16)&&Le(J,y[4]),S[0]&32){ie=y[5];let I;for(I=0;I<ie.length;I+=1){const ue=st(y,ie,I);L[I]?L[I].p(ue,S):(L[I]=rt(ue),L[I].c(),L[I].m(A,U))}for(;I<L.length;I+=1)L[I].d(1);L.length=ie.length}(!M||S[0]&1024)&&Le(se,y[10]),S[0]&8&&W.value!==y[3]&&Xe(W,y[3]),y[6]?P?(P.p(y,S),S[0]&64&&xe(P,1)):(P=lt(y),P.c(),xe(P,1),P.m(e,le)):P&&(Dt(),Ce(P,1,1,()=>{P=null}),St()),y[7]?O?O.p(y,S):(O=ot(y),O.c(),O.m(e,null)):O&&(O.d(1),O=null)},i(y){M||(xe(P),M=!0)},o(y){Ce(P),M=!1},d(y){y&&m(e),ht(L,y),s[27](null),s[29](null),P&&P.d(),O&&O.d(),ve=!1,Ke(De)}}}let Ue="jndl",je="alex";async function ct(s){var r;if(typeof((r=crypto==null?void 0:crypto.subtle)==null?void 0:r.digest)!="function")return"sha256:unavailable";const e=new TextEncoder().encode(s),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}function ze(s){const e="/home/"+je;return s===e?"~":s.startsWith(e+"/")?"~"+s.slice(e.length):s}function Jt(s){const e=[];let t="",n=!1;for(let r=0;r<s.length;r++){const a=s[r];if(a==='"'){n=!n;continue}if(!n&&/\s/.test(a)){t&&(e.push(t),t="");continue}t+=a}return t&&e.push(t),e}function Ae(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Gt(s){return s==="~"||s.startsWith("~/")?"/home/"+je+(s.length>1?s.slice(1):""):s}function Mt(s){if(!s.length)return"";let e=s[0];for(const t of s.slice(1)){let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;if(e=e.slice(0,n),!e)break}return e}function*bt(s,e){for(const t of s.children){const n=t.type==="dir";yield`${e}${t.name}${n?"/":""}`,n&&(yield*bt(t,e+"  "))}}function Ut(s,e,t){let n,r=tt(),a,o,h="",g=[],w=-1;const H=new Date;let X=0,$=null,B=[];const C={help:"help — list available commands",ls:"ls [path] — list directory contents (click names to open)",tree:"tree [path] — show directory tree",pwd:"pwd — print working directory",cd:"cd <path> — change directory",cat:"cat <file> — print file to terminal",echo:'echo "text" > file — write or append with >>',touch:"touch <file> — create an empty file",mkdir:"mkdir [-p] <dir> — create directory",rm:"rm [-r] <path> — remove file or directory",clear:"clear — clear the screen",whoami:"whoami — print current user",date:"date — print current date/time",uname:"uname — print kernel info",ip:"ip — print public IP address",man:"man <cmd> — show a short description",resetfs:"resetfs — reset filesystem to defaults (clears local storage)",play:"play — open the Persephone story",save:"save — save current Persephone run",load:"load — load saved Persephone run",reset:"reset — reset Persephone run","persephone --bloom":"persephone --bloom — attempt to bloom the signal","whois alex":"whois alex — post metadata + checksum hint"};let F=!1,T=!1,D=null,J=null,te=null;const me=4+Math.random()*4,Y=Math.random()*3;function A(){try{const l=localStorage.getItem(Re);t(9,te=l?JSON.parse(l):null)}catch{t(9,te=null)}}async function U(){var l,d;if(!D){try{const p=await fetch("/story.json");if(p.ok){const u=await p.json();D=u.meta||null,t(8,J=((l=u.meta)==null?void 0:l.loreRegistry)||null);return}}catch{}try{const u=await(await fetch("/assets/persephone-run.json")).json();D=u.meta||null,t(8,J=((d=u.meta)==null?void 0:d.loreRegistry)||null)}catch{}}}const ne={status:"decrypted",shards:6,hint:"six seeds bloom a signal",routes:["/blog/welcome","/"]};function oe(l){var d;try{const p=((d=l==null?void 0:l.state)==null?void 0:d.loreDiscoveries)||[];return!Array.isArray(p)||!J?[]:p.map(u=>J.find(_=>_.slug===u)).filter(Boolean)}catch{return[]}}function se(){const l=Rt();l?t(0,r=l):Be(r),re('<span class="g">Welcome</span> — type <span class="y">help</span> to get started.'),re(`<div class="onboard">Quick start:
      <a href="#" class="cmd" data-cmd="ls">list files</a>
      · <a href="/blog" class="nav">blog</a>
      <div class="hint">Tip: use <b>ls</b> to list, <b>cat &lt;file&gt;</b> to read, <b>cd &lt;dir&gt;</b> to open</div>
    </div>`),re('<div class="onboard"><span class="y">hints</span>: names resolve to records · six seeds bloom a signal</div>')}function de(){o==null||o.focus()}function W(){a==null||a.scrollTo({top:a.scrollHeight})}function re(l){t(5,B=[...B,{html:l}]),Pt().then(()=>{W()})}async function ae(l){var x,ee,ce,Ve,ye,qe,Ye,Qe,Ze;const d=l.trim();if(re(`<span class="cmdline"><span class="prompt">${Ae(n)}</span> <span class="cmdtext">${Ae(l)}</span></span>`),!d)return;g.push(l),w=g.length;const[p,...u]=Jt(d),_=[],c=(_e,ge=!1)=>_.push({text:_e,raw:ge});try{const _e=(p||"").toLowerCase(),ge=u.map(j=>(j||"").toLowerCase());switch(_e){case"help":c(Object.keys(C).join(", "));break;case"pwd":c(r.cwd);break;case"whoami":c(je);break;case"date":c(new Date().toString());break;case"uname":c("Linux persephone 6.1.0 x86_64 (web)");break;case"ip":{try{const E=await(await fetch("https://api.ipify.org?format=json",{cache:"no-store"})).json();c(`public: ${E.ip}`)}catch{c("ip: unable to fetch external IP")}break}case"clear":t(5,B=[]);break;case"cd":q(u,c);break;case"ls":le(u,c);break;case"tree":M(u,c);break;case"cat":ve(u,c);break;case"echo":De(u,c);break;case"touch":ie(u,c);break;case"mkdir":L(u,c);break;case"rm":P(u,c);break;case"resetfs":{jt(),t(0,r=tt()),Be(r),c("filesystem reset to defaults");break}case"man":{const j=u[0];if(!j){c("man: missing command");break}const E=C[j];c(E||`No manual entry for ${j}`);break}case"play":{await U(),t(6,F=!0),c("opening game…");break}case"save":{c("persephone: auto-saved (if a run is in progress).");break}case"load":{if(!!!localStorage.getItem(Re)){c("persephone: no save found");break}t(6,F=!0),c("persephone: loaded (open window).");break}case"reset":{localStorage.removeItem(Re),c("persephone: save cleared");break}case"whois":{await U();const j=(ge[0]||"").toLowerCase();if(j==="alex"){if(!(D!=null&&D.webTieIn)){c("whois: info unavailable");break}const E=D.webTieIn,Se=await ct(`${E.blogTitle}|${E.blogDate}`);c(`title: ${E.blogTitle}
date: ${E.blogDate}
author: ${E.blogAuthor}
summary: ${E.summary||""}
checksum: ${Se.slice(0,16)}…`)}else if(j==="johnny")try{const E=localStorage.getItem("persephone-run-v1:save"),Se=E?JSON.parse(E):null,It=!!(((x=Se==null?void 0:Se.state)==null?void 0:x.loreDiscoveries)||[]).includes("johnny-silverhand");c(It?"record shows JOHNNY S— (silver tape wrapped on right hand).":"record incomplete.")}catch{c("record incomplete.")}else c("whois: try `whois alex`");break}case"persephone":{if(ge[0]==="--bloom"){await U();try{const j=localStorage.getItem(Re);if(!j){c("no bloom: signal dormant");break}const E=JSON.parse(j);!!((ce=(ee=E==null?void 0:E.state)==null?void 0:ee.flags)!=null&&ce.blogPosted)&&((ye=(Ve=E==null?void 0:E.state)==null?void 0:Ve.flags)==null?void 0:ye.blogClean)===!1?(t(7,T=!0),c("bloom: signal decrypted (open panel)"),A()):c("no bloom: signal dormant")}catch{c("no bloom: signal dormant")}}else c("persephone: unknown flag");break}case"pomegranate":case"kore13":{await U();try{const j=localStorage.getItem(Re);if(!j){c("no bloom: signal dormant");break}const E=JSON.parse(j);!!((Ye=(qe=E==null?void 0:E.state)==null?void 0:qe.flags)!=null&&Ye.blogPosted)&&((Ze=(Qe=E==null?void 0:E.state)==null?void 0:Qe.flags)==null?void 0:Ze.blogClean)===!1?(t(7,T=!0),c("bloom: signal decrypted (open panel)"),A()):c("no bloom: signal dormant")}catch{c("no bloom: signal dormant")}break}default:if(_e+" "+(ge[0]||"")=="whois alex"){if(await U(),!(D!=null&&D.webTieIn)){c("whois: info unavailable");break}const j=D.webTieIn,E=await ct(`${j.blogTitle}|${j.blogDate}`);c(`title: ${j.blogTitle}
date: ${j.blogDate}
author: ${j.blogAuthor}
summary: ${j.summary||""}
checksum: ${E.slice(0,16)}…`)}else c(`${p}: command not found`)}}catch(_e){c(String(_e))}if(_.length){const _e=_.map(ge=>ge.raw?ge.text:Ae(ge.text)).join(`
`);re(_e)}Be(r)}function fe(l){const d=Gt(l),p=d.startsWith("/")?d:he(r.cwd,d),u=p.endsWith("/"),_=u?p:p.substring(0,p.lastIndexOf("/")>=0?p.lastIndexOf("/"):0),c=u?"":p.split("/").pop()||"",x=Ee(r.root,_||"/").node;if(!x||x.type!=="dir")return{next:null,suggestions:[]};const ce=x.children.map(ye=>ye.type==="dir"?ye.name+"/":ye.name).filter(ye=>ye.startsWith(c));if(ce.length===0)return{next:null,suggestions:[]};if(ce.length===1)return{next:u?p:_+"/"+ce[0],suggestions:ce};const Ve=Mt(ce);return Ve.length>c.length?{next:_+"/"+Ve,suggestions:ce}:{next:null,suggestions:ce}}function G(){let l=!1,d=-1;for(let x=0;x<h.length;x++){const ee=h[x];ee==='"'&&(l=!l),!l&&/\s/.test(ee)&&(d=x)}const p=h.slice(0,d+1),u=h.slice(d+1);if(!u)return;const{next:_,suggestions:c}=fe(u);if(_){const x=_.startsWith(r.cwd)?_.replace(r.cwd,"").replace(/^\//,""):_;t(3,h=p+x);return}c.length&&re(c.join("  "))}function q(l,d){const p=he(r.cwd,l[0]??"/"),u=Ee(r.root,p);if(!u.node)return d(`cd: no such file or directory: ${l[0]??"/"}`);if(u.node.type!=="dir")return d(`cd: not a directory: ${l[0]}`);t(0,r.cwd=p,r)}function le(l,d){const p=he(r.cwd,l[0]??"."),{node:u}=Ee(r.root,p);if(!u)return d(`ls: cannot access '${l[0]??"."}': No such file or directory`);if(u.type==="file")return d(u.name);he("/",p);const _=u.children.map(c=>{const x=c.type==="dir"?c.name+"/":c.name;if(c.type==="dir")return Ae(x);const ee=c;return ee.link?`<a href="${ee.link}" class="nav">${Ae(x)}</a>`:Ae(x)}).join("  ");d(_,!0)}function M(l,d){const p=he(r.cwd,l[0]??"."),{node:u}=Ee(r.root,p);if(!u)return d(`tree: ${l[0]??"."}: No such file or directory`);if(u.type==="file")return d(u.name);d(u.name||"/"),d([...bt(u,"  ")].join(`
`))}function ve(l,d){if(!l[0])return d("cat: missing file operand");const p=he(r.cwd,l[0]),{node:u}=Ee(r.root,p);if(!u)return d(`cat: ${l[0]}: No such file or directory`);if(u.type!=="file")return d(`cat: ${l[0]}: Is a directory`);d(u.content)}function De(l,d){const p=l.findIndex(u=>u===">"||u===">>");if(p>=0){const u=l.slice(0,p).join(" "),_=l[p]===">>",c=l[p+1];if(!c)return d("echo: redirection needs a file");const x=he(r.cwd,c),ee=Ee(r.root,x);if(!ee.node){const ce=Me(r.root,x.substring(0,x.lastIndexOf("/")),!0).node;if(!ce)return d(`echo: cannot create file '${c}'`);ce.children.push(N(x.split("/").pop()||"file.txt",u+(_?"":`
`))),Be(r);return}if(ee.node.type!=="file")return d(`echo: ${c}: Is a directory`);ee.node.content=_?ee.node.content+u:u+`
`,ee.node.updatedAt=Je();return}d(l.join(" "))}function ie(l,d){if(!l[0])return d("touch: missing file operand");const p=he(r.cwd,l[0]),u=Ee(r.root,p);if(!u.node){const _=p.substring(0,p.lastIndexOf("/"))||"/",{node:c}=Me(r.root,_,!0);if(!c)return d(`touch: cannot create '${l[0]}'`);c.children.push(N(p.split("/").pop()||"file.txt",""));return}if(u.node.type!=="file")return d(`touch: ${l[0]}: Is a directory`);u.node.updatedAt=Je()}function L(l,d){if(!l[0])return d("mkdir: missing operand");const p=l[0]==="-p",u=p?l[1]:l[0];if(!u)return d("mkdir: missing operand");const _=he(r.cwd,u);if(!Me(r.root,_,p).node)return d(`mkdir: cannot create directory '${u}'`)}function P(l,d){if(!l[0])return d("rm: missing operand");const p=l[0]==="-r",u=p?l[1]:l[0],_=he(r.cwd,u);Lt(r.root,_,p)||d(`rm: cannot remove '${u}'`)}function O(l){if(l.key==="Enter"){l.preventDefault();const d=h;t(3,h=""),ae(d)}else l.key==="ArrowUp"?(w>0&&(w-=1,t(3,h=g[w]??"")),l.preventDefault()):l.key==="ArrowDown"?(w<g.length&&(w+=1,t(3,h=g[w]??"")),l.preventDefault()):l.key==="c"&&(l.ctrlKey||l.metaKey)?(re('<span class="prompt">'+n+"</span> "+Ae(h)),t(3,h=""),l.preventDefault()):l.key==="Tab"&&(l.preventDefault(),G())}function y(l){const d=l.target,p=d.closest("a.cmd");if(p){l.preventDefault();const _=p.getAttribute("data-cmd")||"";_&&ae(_);return}const u=d.closest("a.nav");if(u){l.preventDefault();const _=u.getAttribute("href")||"";_&&(window.location.href=_)}}function S(l){const d=l.target;if(!(l.key==="Enter"||l.key===" "))return;const u=d.closest("a.cmd"),_=d.closest("a.nav");if(u){l.preventDefault();const c=u.getAttribute("data-cmd")||"";c&&ae(c);return}if(_){l.preventDefault();const c=_.getAttribute("href")||"";c&&(window.location.href=c)}}At(()=>{se(),de();const l=()=>{t(4,X=Math.floor((Date.now()-H.getTime())/6e4))};l(),$=setInterval(l,1e4),typeof window<"u"&&window.addEventListener("persephone:save",A)}),Nt(()=>{$&&clearInterval($),typeof window<"u"&&window.removeEventListener("persephone:save",A)});function I(l){we.call(this,s,l)}function ue(l){we.call(this,s,l)}function be(l){we.call(this,s,l)}function Ne(l){we.call(this,s,l)}function ke(l){we.call(this,s,l)}function Pe(l){we.call(this,s,l)}function Te(l){we.call(this,s,l)}function He(l){we.call(this,s,l)}function Oe(l){$e[l?"unshift":"push"](()=>{o=l,t(2,o)})}function kt(){h=this.value,t(3,h)}function yt(l){$e[l?"unshift":"push"](()=>{a=l,t(1,a)})}const _t=()=>t(6,F=!1),wt=()=>t(7,T=!1),Et=l=>{(l.key.length===1||l.key==="/"||l.key===" ")&&de()};return s.$$.update=()=>{s.$$.dirty[0]&1&&t(10,n=`${je}@${Ue}:${ze(r.cwd)}$`)},[r,a,o,h,X,B,F,T,J,te,n,me,Y,ne,oe,de,O,y,S,I,ue,be,Ne,ke,Pe,Te,He,Oe,kt,yt,_t,wt,Et]}class zt extends ut{constructor(e){super(),dt(this,e,Ut,Ct,ft,{},null,[-1,-1])}}function Kt(s){let e,t;return e=new zt({}),{c(){pt(e.$$.fragment)},l(n){mt(e.$$.fragment,n)},m(n,r){gt(e,n,r),t=!0},p:Ge,i(n){t||(xe(e.$$.fragment,n),t=!0)},o(n){Ce(e.$$.fragment,n),t=!1},d(n){vt(e,n)}}}class Yt extends ut{constructor(e){super(),dt(this,e,null,Kt,ft,{})}}export{Yt as default};
